<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>EnergyEvaluation · ParallelTemperingMonteCarlo</title><meta name="title" content="EnergyEvaluation · ParallelTemperingMonteCarlo"/><meta property="og:title" content="EnergyEvaluation · ParallelTemperingMonteCarlo"/><meta property="twitter:title" content="EnergyEvaluation · ParallelTemperingMonteCarlo"/><meta name="description" content="Documentation for ParallelTemperingMonteCarlo."/><meta property="og:description" content="Documentation for ParallelTemperingMonteCarlo."/><meta property="twitter:description" content="Documentation for ParallelTemperingMonteCarlo."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">ParallelTemperingMonteCarlo</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../BoundaryConditions/">BoundaryConditions</a></li><li><a class="tocitem" href="../Configurations/">Configurations</a></li><li><a class="tocitem" href="../CustomTypes/">CustomTypes</a></li><li class="is-active"><a class="tocitem" href>EnergyEvaluation</a></li><li><a class="tocitem" href="../Ensembles/">Ensembles</a></li><li><a class="tocitem" href="../Exchange/">Exchange</a></li><li><a class="tocitem" href="../Initialization/">Initialization</a></li><li><a class="tocitem" href="../InputParams/">InputParams</a></li><li><a class="tocitem" href="../MCMoves/">MCMoves</a></li><li><a class="tocitem" href="../MCRun/">MCRun</a></li><li><a class="tocitem" href="../MCSampling/">MCSampling</a></li><li><a class="tocitem" href="../MCStates/">MCStates</a></li><li><a class="tocitem" href="../MachineLearningPotential/">MachineLearningPotential</a></li><li><a class="tocitem" href="../Multihistogram/">Multihistogram</a></li><li><a class="tocitem" href="../Multihistogram_NPT/">Multihistogram_NPT</a></li><li><a class="tocitem" href="../Multihistogram_NVT/">Multihistogram_NVT</a></li><li><a class="tocitem" href="../ReadSave/">ReadSave</a></li><li><span class="tocitem">MachineLearningPotential</span><ul><li><a class="tocitem" href="../MachineLearningPotential/">MachineLearningPotential</a></li><li><a class="tocitem" href="../Cutoff/">Cutoff</a></li><li><a class="tocitem" href="../DeltaMatrix/">DeltaMatrix</a></li><li><a class="tocitem" href="../ForwardPass/">ForwardPass</a></li><li><a class="tocitem" href="../SymmetryFunctions/">SymmetryFunctions</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../ne13/">ne13.jl</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>EnergyEvaluation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>EnergyEvaluation</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/ElkePahl/ParallelTemperingMonteCarlo.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/ElkePahl/ParallelTemperingMonteCarlo.jl/blob/main/docs/src/EnergyEvaluation.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="EnergyEvaluation"><a class="docs-heading-anchor" href="#EnergyEvaluation">EnergyEvaluation</a><a id="EnergyEvaluation-1"></a><a class="docs-heading-anchor-permalink" href="#EnergyEvaluation" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ParallelTemperingMonteCarlo.EnergyEvaluation" href="#ParallelTemperingMonteCarlo.EnergyEvaluation"><code>ParallelTemperingMonteCarlo.EnergyEvaluation</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">module EnergyEvaluation</code></pre><p>Structs and functions relating to the calculation of energy. Includes both low and high level functions from individual PES calculations to state-specific functions. The structure is as follows:</p><ul><li>Define abstract potential and potential_variables</li><li>Define PES functions<ul><li>DimerPotential </li><li>ELJB </li><li>Embedded Atom Model </li><li>Machine Learning Potentials </li></ul></li><li>EnergyUpdate function<ul><li>Calculates a new energy based on a trialpos for each PES type </li></ul></li><li>InitialiseEnergy function <ul><li>Calculates potentialvariables and total energy from a new config to be used when initialising MCStates </li></ul></li><li>SetVariables function <ul><li>Initialises the potential variables, aka creates a blank version of the struct for each type of PES</li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ElkePahl/ParallelTemperingMonteCarlo.jl/blob/de5fd98cf5cc052a3b463e89115edde062b7b303/src/EnergyEvaluation.jl#L1-L16">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ParallelTemperingMonteCarlo.EnergyEvaluation.AbstractDimerPotential" href="#ParallelTemperingMonteCarlo.EnergyEvaluation.AbstractDimerPotential"><code>ParallelTemperingMonteCarlo.EnergyEvaluation.AbstractDimerPotential</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">AbstractDimerPotential &lt;: AbstractPotential</code></pre><p>Implemented dimer potentials:   </p><ul><li><a href="#ParallelTemperingMonteCarlo.EnergyEvaluation.ELJPotential"><code>ELJPotential</code></a></li><li><a href="#ParallelTemperingMonteCarlo.EnergyEvaluation.ELJPotentialEven"><code>ELJPotentialEven</code></a></li></ul><p>Needs methods for </p><ul><li><a href="#ParallelTemperingMonteCarlo.EnergyEvaluation.dimer_energy_atom-Tuple{Int64, AbstractVector{Z} where Z&lt;:Number, AbstractDimerPotential}"><code>dimer_energy_atom</code></a></li><li><a href="#ParallelTemperingMonteCarlo.EnergyEvaluation.dimer_energy_config-Tuple{Matrix{Float64}, Int64, DimerPotentialVariables, AbstractDimerPotential}"><code>dimer_energy_config</code></a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ElkePahl/ParallelTemperingMonteCarlo.jl/blob/de5fd98cf5cc052a3b463e89115edde062b7b303/src/EnergyEvaluation.jl#L85-L94">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ParallelTemperingMonteCarlo.EnergyEvaluation.AbstractDimerPotentialB" href="#ParallelTemperingMonteCarlo.EnergyEvaluation.AbstractDimerPotentialB"><code>ParallelTemperingMonteCarlo.EnergyEvaluation.AbstractDimerPotentialB</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">AbstractDimerPotentialB &lt;: AbstractPotential</code></pre><p>Implemented dimer potentials:   </p><ul><li><a href="#ParallelTemperingMonteCarlo.EnergyEvaluation.ELJPotentialB"><code>ELJPotentialB</code></a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ElkePahl/ParallelTemperingMonteCarlo.jl/blob/de5fd98cf5cc052a3b463e89115edde062b7b303/src/EnergyEvaluation.jl#L96-L100">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ParallelTemperingMonteCarlo.EnergyEvaluation.AbstractMachineLearningPotential" href="#ParallelTemperingMonteCarlo.EnergyEvaluation.AbstractMachineLearningPotential"><code>ParallelTemperingMonteCarlo.EnergyEvaluation.AbstractMachineLearningPotential</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">AbstractMachineLearningPotential &lt;: AbstractPotential</code></pre><p>Abstract type for all Machine Learning Potentials.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ElkePahl/ParallelTemperingMonteCarlo.jl/blob/de5fd98cf5cc052a3b463e89115edde062b7b303/src/EnergyEvaluation.jl#L649-L652">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ParallelTemperingMonteCarlo.EnergyEvaluation.AbstractPotential" href="#ParallelTemperingMonteCarlo.EnergyEvaluation.AbstractPotential"><code>ParallelTemperingMonteCarlo.EnergyEvaluation.AbstractPotential</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">AbstractPotential</code></pre><p>Abstract type for possible potentials. implemented subtype: </p><ul><li><a href="#ParallelTemperingMonteCarlo.EnergyEvaluation.AbstractDimerPotential"><code>AbstractDimerPotential</code></a></li><li><a href="#ParallelTemperingMonteCarlo.EnergyEvaluation.AbstractDimerPotentialB"><code>AbstractDimerPotentialB</code></a></li><li><a href="#ParallelTemperingMonteCarlo.EnergyEvaluation.EmbeddedAtomPotential"><code>EmbeddedAtomPotential</code></a></li><li><a href="#ParallelTemperingMonteCarlo.EnergyEvaluation.AbstractMachineLearningPotential"><code>AbstractMachineLearningPotential</code></a></li></ul><p>When defining a new type, the functions relating a potential to the rest of the Monte Carlo code are explicated at the end of this file. Each potential also requires a PotentialVariable <a href="#ParallelTemperingMonteCarlo.EnergyEvaluation.AbstractPotentialVariables"><code>AbstractPotentialVariables</code></a> struct to hold all non-static information relating a potential to the current configuration. </p><p>Needs method for:</p><ul><li><a href="#ParallelTemperingMonteCarlo.EnergyEvaluation.energy_update!-Union{Tuple{Etype}, Tuple{Etype, Config, AbstractPotentialVariables, Matrix{Float64}, Vector{Float64}, Number, AbstractDimerPotential}} where Etype&lt;:NVTVariables"><code>energy_update!</code></a></li><li><a href="#ParallelTemperingMonteCarlo.EnergyEvaluation.initialise_energy-Tuple{Config, Matrix{Float64}, AbstractPotentialVariables, NVTVariables, AbstractDimerPotential}"><code>initialise_energy</code></a> </li><li><a href="#ParallelTemperingMonteCarlo.EnergyEvaluation.set_variables-Union{Tuple{T}, Tuple{BC}, Tuple{N}, Tuple{Config{N, BC, T}, Matrix{Float64}, AbstractDimerPotential}} where {N, BC, T}"><code>set_variables</code></a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ElkePahl/ParallelTemperingMonteCarlo.jl/blob/de5fd98cf5cc052a3b463e89115edde062b7b303/src/EnergyEvaluation.jl#L46-L64">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ParallelTemperingMonteCarlo.EnergyEvaluation.AbstractPotentialVariables" href="#ParallelTemperingMonteCarlo.EnergyEvaluation.AbstractPotentialVariables"><code>ParallelTemperingMonteCarlo.EnergyEvaluation.AbstractPotentialVariables</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">AbstractPotentialVariables</code></pre><p>An abstract type defining a class of mutable struct containing all the relevant vectors and arrays each potential will need throughout the course of a simulation to prevent over-definitions inside the MCState struct. Implemented subtypes:</p><ul><li><a href="#ParallelTemperingMonteCarlo.EnergyEvaluation.DimerPotentialVariables"><code>DimerPotentialVariables</code></a></li><li><a href="#ParallelTemperingMonteCarlo.EnergyEvaluation.ELJPotentialBVariables"><code>ELJPotentialBVariables</code></a></li><li><a href="#ParallelTemperingMonteCarlo.EnergyEvaluation.EmbeddedAtomVariables"><code>EmbeddedAtomVariables</code></a></li><li><a href="#ParallelTemperingMonteCarlo.EnergyEvaluation.NNPVariables"><code>NNPVariables</code></a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ElkePahl/ParallelTemperingMonteCarlo.jl/blob/de5fd98cf5cc052a3b463e89115edde062b7b303/src/EnergyEvaluation.jl#L68-L77">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ParallelTemperingMonteCarlo.EnergyEvaluation.DimerPotentialVariables" href="#ParallelTemperingMonteCarlo.EnergyEvaluation.DimerPotentialVariables"><code>ParallelTemperingMonteCarlo.EnergyEvaluation.DimerPotentialVariables</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">DimerPotentialVariables</code></pre><p>The struct contains only the <code>en_atom_vec::Vector{T}</code>, particular special features for this potential type.  This vector is the energy per atom in the system.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ElkePahl/ParallelTemperingMonteCarlo.jl/blob/de5fd98cf5cc052a3b463e89115edde062b7b303/src/EnergyEvaluation.jl#L102-L106">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ParallelTemperingMonteCarlo.EnergyEvaluation.ELJPotential" href="#ParallelTemperingMonteCarlo.EnergyEvaluation.ELJPotential"><code>ParallelTemperingMonteCarlo.EnergyEvaluation.ELJPotential</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ELJPotential{N,T}</code></pre><p>Implements type for extended Lennard Jones potential; subtype of <a href="#ParallelTemperingMonteCarlo.EnergyEvaluation.AbstractDimerPotential"><code>AbstractDimerPotential</code></a>&lt;:<a href="#ParallelTemperingMonteCarlo.EnergyEvaluation.AbstractPotential"><code>AbstractPotential</code></a>; as sum over <code>c_i r^(-i)</code>, starting with <code>i=6</code> up to <code>i=N+6</code> field name: <code>coeff::SVector{N,T}</code> : contains ELJ coefficients <code>c_i</code> from <code>i=6</code> to <code>i=N+6</code>, coefficient for every power needed. Constructors:     ELJPotential{N}(c::VorS) where N     ELJPotential(c::VorS)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ElkePahl/ParallelTemperingMonteCarlo.jl/blob/de5fd98cf5cc052a3b463e89115edde062b7b303/src/EnergyEvaluation.jl#L391-L399">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ParallelTemperingMonteCarlo.EnergyEvaluation.ELJPotentialB" href="#ParallelTemperingMonteCarlo.EnergyEvaluation.ELJPotentialB"><code>ParallelTemperingMonteCarlo.EnergyEvaluation.ELJPotentialB</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ELJPotentialB{N,T}</code></pre><p>Extended Lennard-Jones Potential in a magnetic field where there is anisotropy in the coefficient vectors <code>coeff_a::SVector{N,T}</code>, <code>coeff_b::SVector{N,T}</code>, <code>coeff_c::SVector{N,T}</code>. Constructors:     ELJPotentialB{N}(a::VorS, b::VorS, c::VorS) where N     ELJPotentialB(a::VorS, b::VorS, c::VorS)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ElkePahl/ParallelTemperingMonteCarlo.jl/blob/de5fd98cf5cc052a3b463e89115edde062b7b303/src/EnergyEvaluation.jl#L139-L145">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ParallelTemperingMonteCarlo.EnergyEvaluation.ELJPotentialBVariables" href="#ParallelTemperingMonteCarlo.EnergyEvaluation.ELJPotentialBVariables"><code>ParallelTemperingMonteCarlo.EnergyEvaluation.ELJPotentialBVariables</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ELJPotentialBVariables{T}</code></pre><p>Contains the <code>en_atom_vec::Array{T}</code>, <code>tan_mat::Matrix{T}</code> and <code>new_tan_vec::Vector{T}</code> for the ELJPotentialB potential.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ElkePahl/ParallelTemperingMonteCarlo.jl/blob/de5fd98cf5cc052a3b463e89115edde062b7b303/src/EnergyEvaluation.jl#L167-L170">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ParallelTemperingMonteCarlo.EnergyEvaluation.ELJPotentialEven" href="#ParallelTemperingMonteCarlo.EnergyEvaluation.ELJPotentialEven"><code>ParallelTemperingMonteCarlo.EnergyEvaluation.ELJPotentialEven</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ELJPotentialEven{N,T}</code></pre><p>Implements type for extended Lennard Jones potential with only even powers; subtype of <a href="#ParallelTemperingMonteCarlo.EnergyEvaluation.AbstractDimerPotential"><code>AbstractDimerPotential</code></a>&lt;:<a href="#ParallelTemperingMonteCarlo.EnergyEvaluation.AbstractPotential"><code>AbstractPotential</code></a>; as sum over <code>c_i r^(-i)</code>, starting with <code>i=6</code> up to <code>i=N+6</code> with only even integers <code>i</code> field name: <code>coeff::SVector{N,T}</code> : contains ELJ coefficients <code>c_i</code> from <code>i=6</code> to <code>i=N+6</code> in steps of 2, coefficient for every even power needed. Constructors:     ELJPotentialEven{N}(c::VorS) where N     ELJPotentialEven(c::VorS)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ElkePahl/ParallelTemperingMonteCarlo.jl/blob/de5fd98cf5cc052a3b463e89115edde062b7b303/src/EnergyEvaluation.jl#L115-L123">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ParallelTemperingMonteCarlo.EnergyEvaluation.EmbeddedAtomPotential" href="#ParallelTemperingMonteCarlo.EnergyEvaluation.EmbeddedAtomPotential"><code>ParallelTemperingMonteCarlo.EnergyEvaluation.EmbeddedAtomPotential</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">EmbeddedAtomPotential</code></pre><p>Struct containing the important quantities for calculating EAM (specifically Sutton-Chen type) potentials.</p><ul><li>Fields:<ul><li><code>n::Float64</code> the exponent for the two-body repulsive ϕ component</li><li><code>m::Float64</code> the exponent for the embedded electron density ρ</li><li><code>ean::Float64</code> multiplicative factor <code>ϵa^n /2</code> for ϕ</li><li><code>eCam::Float64</code> multiplicative factor <code>ϵCa^(m/2)</code> for ρ </li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ElkePahl/ParallelTemperingMonteCarlo.jl/blob/de5fd98cf5cc052a3b463e89115edde062b7b303/src/EnergyEvaluation.jl#L540-L549">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ParallelTemperingMonteCarlo.EnergyEvaluation.EmbeddedAtomPotential-NTuple{5, Number}" href="#ParallelTemperingMonteCarlo.EnergyEvaluation.EmbeddedAtomPotential-NTuple{5, Number}"><code>ParallelTemperingMonteCarlo.EnergyEvaluation.EmbeddedAtomPotential</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">EmbeddedAtomPotential(n::Number,m::Number,ϵ::Number,C::Number,a::Number)</code></pre><p>Function to initalise the EAM struct given the actual constants cited in papers. The exponents <code>n</code>,<code>m</code>, the energy constant <code>ϵ</code> the distance constant <code>a</code> standard in all EAM models, and a dimensionless parameter <code>C</code> scaling ρ with respect to ϕ.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ElkePahl/ParallelTemperingMonteCarlo.jl/blob/de5fd98cf5cc052a3b463e89115edde062b7b303/src/EnergyEvaluation.jl#L556-L559">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ParallelTemperingMonteCarlo.EnergyEvaluation.EmbeddedAtomVariables" href="#ParallelTemperingMonteCarlo.EnergyEvaluation.EmbeddedAtomVariables"><code>ParallelTemperingMonteCarlo.EnergyEvaluation.EmbeddedAtomVariables</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">EmbeddedAtomVariables{T}</code></pre><p>Contains the <code>component_vector::Matrix{T}</code> and <code>new_component_vector::Matrix{T}</code> for the EAM potential.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ElkePahl/ParallelTemperingMonteCarlo.jl/blob/de5fd98cf5cc052a3b463e89115edde062b7b303/src/EnergyEvaluation.jl#L566-L569">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ParallelTemperingMonteCarlo.EnergyEvaluation.NNPVariables" href="#ParallelTemperingMonteCarlo.EnergyEvaluation.NNPVariables"><code>ParallelTemperingMonteCarlo.EnergyEvaluation.NNPVariables</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">NNPVariables{T}</code></pre><p>Bundle of variables used for the NNP potential: </p><ul><li><code>en_atom_vec::Vector{T}</code> – the per-atom energy vector</li><li><code>new_en_atom::Vector{T}</code> – the new per-atom energy vector</li><li><code>g_matrix::Matrix{T}</code> – the G matrix</li><li><code>f_matrix::Matrix{T}</code> – the F matrix</li><li><code>new_g_matrix::Matrix{T}</code> – the new G matrix</li><li><code>new_f_vec::Vector{T}</code> – the new F vector</li></ul><p>Todo: someone who knows what these are should write a better description</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ElkePahl/ParallelTemperingMonteCarlo.jl/blob/de5fd98cf5cc052a3b463e89115edde062b7b303/src/EnergyEvaluation.jl#L693-L703">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ParallelTemperingMonteCarlo.EnergyEvaluation.NNPVariables2a" href="#ParallelTemperingMonteCarlo.EnergyEvaluation.NNPVariables2a"><code>ParallelTemperingMonteCarlo.EnergyEvaluation.NNPVariables2a</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">NNPVariables2a{T,Na,Ng} &lt;: AbstractPotentialVariables
T  variable type, usually Float64 
Na number of atoms
Ng number of symmetry functions</code></pre><p>Mutable parameters relevant to a 2 atom NNP using the RuNNer Package.  fields include:     -en<em>atom</em>vec: atomic energy corresponding to config     -new<em>en</em>atom: after an atom move, the new atomic energy     -g<em>matrix: matrix of symmetry values, length NgxNa     -f</em>matrix: matrix of cutoff function values aor atom pairs i,j     -new<em>g</em>matrix: after atom move, new symmetry values     -new<em>f</em>vec: after atom move, new cutoff values</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ElkePahl/ParallelTemperingMonteCarlo.jl/blob/de5fd98cf5cc052a3b463e89115edde062b7b303/src/EnergyEvaluation.jl#L771-L784">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ParallelTemperingMonteCarlo.EnergyEvaluation.RuNNerPotential" href="#ParallelTemperingMonteCarlo.EnergyEvaluation.RuNNerPotential"><code>ParallelTemperingMonteCarlo.EnergyEvaluation.RuNNerPotential</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">RuNNerPotential &lt;: AbstractMachineLearningPotential</code></pre><p>Contains the important structs required for a neural network potential defined in the MachineLearningPotential package:</p><ul><li>Fields are:<ul><li><code>nnp::NeuralNetworkPotential</code> – a struct containing the weights, biases and neural network parameters.</li><li><code>radsymfunctions::StructVector{RadialType2{Float64}}</code> – a vector containing the hyperparameters used to calculate symmetry function values</li><li><code>angsymfunctions::StructVector{AngularType3{Float64}}</code> – a vector containing the hyperparameters used to calculate symmetry function values</li><li><code>r_cut::Float64</code> – every symmetry function has an r_cut, but saving it here saves annoying memory unpacking </li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ElkePahl/ParallelTemperingMonteCarlo.jl/blob/de5fd98cf5cc052a3b463e89115edde062b7b303/src/EnergyEvaluation.jl#L655-L663">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ParallelTemperingMonteCarlo.EnergyEvaluation.RuNNerPotential-Union{Tuple{N}, Tuple{NeuralNetworkPotential, Array{RadialType2{N}, 1}, Array{AngularType3{N}, 1}}} where N&lt;:Number" href="#ParallelTemperingMonteCarlo.EnergyEvaluation.RuNNerPotential-Union{Tuple{N}, Tuple{NeuralNetworkPotential, Array{RadialType2{N}, 1}, Array{AngularType3{N}, 1}}} where N&lt;:Number"><code>ParallelTemperingMonteCarlo.EnergyEvaluation.RuNNerPotential</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">RuNNerPotential(nnp::NeuralNetworkPotential,radsymvec::VorS,angsymvec::VorS)</code></pre><p>RuNNerPotential constructor/initializer function, given a neural network potential <code>nnp</code> and the symmetry functions <code>radsymvec,angsymvec</code> and the cutoff radius <code>r_cut</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ElkePahl/ParallelTemperingMonteCarlo.jl/blob/de5fd98cf5cc052a3b463e89115edde062b7b303/src/EnergyEvaluation.jl#L671-L674">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ParallelTemperingMonteCarlo.EnergyEvaluation.RuNNerPotential2Atom" href="#ParallelTemperingMonteCarlo.EnergyEvaluation.RuNNerPotential2Atom"><code>ParallelTemperingMonteCarlo.EnergyEvaluation.RuNNerPotential2Atom</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">RuNNerPotential2Atom &lt;: AbstractMachineLearningPotential</code></pre><p>Contains the important structs required for a neural network potential defined in the MachineLearningPotential package for a 2 atom system:     Fields are:     nnp# – structs containing the weights, biases and neural network parameters.     symmetryfunctions – a vector containing the hyperparameters used to calculate symmetry function values     r<em>cut – every symmetry function has an r</em>cut, but saving it here saves annoying memory unpacking </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ElkePahl/ParallelTemperingMonteCarlo.jl/blob/de5fd98cf5cc052a3b463e89115edde062b7b303/src/EnergyEvaluation.jl#L735-L742">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ParallelTemperingMonteCarlo.EnergyEvaluation.calc_components-Tuple{AbstractVector{Z} where Z&lt;:Number, AbstractVector{Z} where Z&lt;:Number, Number, Number}" href="#ParallelTemperingMonteCarlo.EnergyEvaluation.calc_components-Tuple{AbstractVector{Z} where Z&lt;:Number, AbstractVector{Z} where Z&lt;:Number, Number, Number}"><code>ParallelTemperingMonteCarlo.EnergyEvaluation.calc_components</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calc_components(componentvec::VorS,distancevec::VorS,n::Number,m::Number)
calc_components(new_component_vec::Matrix{Float64},atomindex::Int,old_r2_vec::VorS,new_r2_vec::VorS,n::Number,m::Number)
calc_components(component_vec::Matrix{Float64},new_component_vec::Matrix{Float64},atomindex::Int,old_r2_vec::VorS,new_r2_vec::VorS,n::Number,m::Number)</code></pre><p>Primary calculation of ϕ,ρ for atom i, given each other atom&#39;s distance to i in <code>distancevec</code>. <code>eatomvec</code> stores the ϕ and ρ components.</p><p>Second method also includes an existing <code>new_component_vec</code> <code>atomindex</code> and old and new interatomic distances from an atom at <code>atomindex</code> stored in vectors <code>new_r2_vec,old_r2_vec</code>. This calculates the <code>new_component_vec</code> based on the updated distances and returns this.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ElkePahl/ParallelTemperingMonteCarlo.jl/blob/de5fd98cf5cc052a3b463e89115edde062b7b303/src/EnergyEvaluation.jl#L587-L595">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ParallelTemperingMonteCarlo.EnergyEvaluation.calc_new_runner_energy!-Tuple{NNPVariables, RuNNerPotential}" href="#ParallelTemperingMonteCarlo.EnergyEvaluation.calc_new_runner_energy!-Tuple{NNPVariables, RuNNerPotential}"><code>ParallelTemperingMonteCarlo.EnergyEvaluation.calc_new_runner_energy!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calc_new_runner_energy!(potential_variables::NNPVariables,pot::RuNNerPotential)</code></pre><p>Function designed to calculate the new per-atom energy according to the RuNNer forward pass with parameters defined in <code>pot</code>. utilises the <code>new_g_matrix</code> to redefine the <code>new_en</code> and <code>new_en_atom</code> variables within the <code>potential_variables</code> struct.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ElkePahl/ParallelTemperingMonteCarlo.jl/blob/de5fd98cf5cc052a3b463e89115edde062b7b303/src/EnergyEvaluation.jl#L723-L726">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ParallelTemperingMonteCarlo.EnergyEvaluation.calc_new_runner_energy!-Union{Tuple{Ng}, Tuple{Na}, Tuple{T}, Tuple{N2}, Tuple{N1}, Tuple{Nang}, Tuple{Nrad}, Tuple{NNPVariables2a{T, Na, Ng}, RuNNerPotential2Atom{Nrad, Nang, N1, N2}}} where {Nrad, Nang, N1, N2, T, Na, Ng}" href="#ParallelTemperingMonteCarlo.EnergyEvaluation.calc_new_runner_energy!-Union{Tuple{Ng}, Tuple{Na}, Tuple{T}, Tuple{N2}, Tuple{N1}, Tuple{Nang}, Tuple{Nrad}, Tuple{NNPVariables2a{T, Na, Ng}, RuNNerPotential2Atom{Nrad, Nang, N1, N2}}} where {Nrad, Nang, N1, N2, T, Na, Ng}"><code>ParallelTemperingMonteCarlo.EnergyEvaluation.calc_new_runner_energy!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calc_new_runner_energy!(potential_variables::NNPVariables2a{T,Na,Ng},pot::RuNNerPotential2Atom{Nrad,Nang,N1,N2}) where {T,Na,Ng} where {Nrad,Nang,N1,N2}</code></pre><p>Function to calculate the energy of a new configuration after an atom move. Accepts the potential<em>variables struct and runs a forward pass on the new</em>g_matrix. Returns the new energy.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ElkePahl/ParallelTemperingMonteCarlo.jl/blob/de5fd98cf5cc052a3b463e89115edde062b7b303/src/EnergyEvaluation.jl#L824-L827">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ParallelTemperingMonteCarlo.EnergyEvaluation.dimer_energy-Union{Tuple{N}, Tuple{ELJPotential{N}, Number}} where N" href="#ParallelTemperingMonteCarlo.EnergyEvaluation.dimer_energy-Union{Tuple{N}, Tuple{ELJPotential{N}, Number}} where N"><code>ParallelTemperingMonteCarlo.EnergyEvaluation.dimer_energy</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">dimer_energy(pot::ELJPotential{N}, r2::Number) where N
dimer_energy(pot::ELJPotentialEven{N}, r2::Number) where N
dimer_energy(pot::ELJPotentialB{N}, r2::Number, z_angle::Number) where N</code></pre><p>Calculates energy of dimer for given potential <code>pot</code> and squared distance <code>r2</code> between atoms Methods implemented for:</p><ul><li><p><a href="#ParallelTemperingMonteCarlo.EnergyEvaluation.ELJPotential"><code>ELJPotential</code></a></p></li><li><p><a href="#ParallelTemperingMonteCarlo.EnergyEvaluation.ELJPotentialEven"><code>ELJPotentialEven</code></a></p></li></ul><p>Dimer energy when the distance square between two atom is <code>r2</code> and the angle between the line connecting them and z-direction is <code>z_angle</code>. When <code>r2 &lt; 5.30</code>, returns 1.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ElkePahl/ParallelTemperingMonteCarlo.jl/blob/de5fd98cf5cc052a3b463e89115edde062b7b303/src/EnergyEvaluation.jl#L418-L430">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ParallelTemperingMonteCarlo.EnergyEvaluation.dimer_energy_atom-Tuple{Int64, AbstractVector{Z} where Z&lt;:Number, AbstractDimerPotential}" href="#ParallelTemperingMonteCarlo.EnergyEvaluation.dimer_energy_atom-Tuple{Int64, AbstractVector{Z} where Z&lt;:Number, AbstractDimerPotential}"><code>ParallelTemperingMonteCarlo.EnergyEvaluation.dimer_energy_atom</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">dimer_energy_atom(i::Int, d2vec::VorS, pot::AbstractDimerPotential)
dimer_energy_atom(i::Int, d2vec::VorS, r_cut::Number, pot::AbstractDimerPotential)
dimer_energy_atom(i::Int, d2vec::VorS, tanvec::VorS,pot::AbstractDimerPotentialB)
dimer_energy_atom(i::Int, d2vec::VorS, tanvec::VorS, r_cut::Number, pot::AbstractDimerPotentialB)</code></pre><p>Sums the dimer energies for atom <code>i</code> with all other atoms  Needs vector of squared distances <code>d2vec</code> between atom <code>i</code> and all other atoms in configuration See <a href="../Configurations/#ParallelTemperingMonteCarlo.Configurations.get_distance2_mat-Union{Tuple{Config{N}}, Tuple{N}} where N"><code>get_distance2_mat</code></a> and potential information <code>pot</code> <a href="#ParallelTemperingMonteCarlo.EnergyEvaluation.AbstractPotential"><code>AbstractPotential</code></a> </p><p>Second method includes additional variable <code>r_cut</code> to exclude distances outside the cutoff radius of the potential.</p><p>Final two methods relate to the use of magnetic field potentials such as the ELJB potential.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ElkePahl/ParallelTemperingMonteCarlo.jl/blob/de5fd98cf5cc052a3b463e89115edde062b7b303/src/EnergyEvaluation.jl#L179-L192">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ParallelTemperingMonteCarlo.EnergyEvaluation.dimer_energy_config-Tuple{Matrix{Float64}, Int64, DimerPotentialVariables, AbstractDimerPotential}" href="#ParallelTemperingMonteCarlo.EnergyEvaluation.dimer_energy_config-Tuple{Matrix{Float64}, Int64, DimerPotentialVariables, AbstractDimerPotential}"><code>ParallelTemperingMonteCarlo.EnergyEvaluation.dimer_energy_config</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">dimer_energy_config(distmat::Matrix{Float64}, NAtoms::Int, potential_variables::DimerPotentialVariables, pot::AbstractDimerPotential)
dimer_energy_config(distmat::Matrix{Float64}, NAtoms::Int, potential_variables::DimerPotentialVariables, r_cut::Number, bc::CubicBC, pot::AbstractDimerPotential)
dimer_energy_config(distmat::Matrix{Float64}, NAtoms::Int, potential_variables::DimerPotentialVariables, r_cut::Number, bc::RhombicBC, pot::AbstractDimerPotential)
dimer_energy_config(distmat::Matrix{Float64}, NAtoms::Int, potential_variables::ELJPotentialBVariables, pot::AbstractDimerPotentialB)
dimer_energy_config(distmat::Matrix{Float64}, NAtoms::Int, potential_variables::ELJPotentialBVariables, r_cut::Number, bc::CubicBC, pot::AbstractDimerPotentialB)</code></pre><p>Stores the total of dimer energies of one atom with all other atoms in vector and calculates total energy of configuration.</p><p>First two methods are for standard dimer potentials, one with a cutoff radius, one without a cutoff radius. The final two methods are for the same calculation using a magnetic potential such as the ELJB potential. </p><p>Needs squared distances matrix, see <a href="../Configurations/#ParallelTemperingMonteCarlo.Configurations.get_distance2_mat-Union{Tuple{Config{N}}, Tuple{N}} where N"><code>get_distance2_mat</code></a>  and potential information <code>pot</code> <a href="#ParallelTemperingMonteCarlo.EnergyEvaluation.AbstractPotential"><code>AbstractPotential</code></a> </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ElkePahl/ParallelTemperingMonteCarlo.jl/blob/de5fd98cf5cc052a3b463e89115edde062b7b303/src/EnergyEvaluation.jl#L241-L254">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ParallelTemperingMonteCarlo.EnergyEvaluation.dimer_energy_update!-Tuple{Int64, Matrix{Float64}, AbstractVector{Z} where Z&lt;:Number, Float64, AbstractDimerPotential}" href="#ParallelTemperingMonteCarlo.EnergyEvaluation.dimer_energy_update!-Tuple{Int64, Matrix{Float64}, AbstractVector{Z} where Z&lt;:Number, Float64, AbstractDimerPotential}"><code>ParallelTemperingMonteCarlo.EnergyEvaluation.dimer_energy_update!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">dimer_energy_update!(index::Int,dist2_mat::Matrix{Float64},new_dist2_vec::VorS,en_tot::Float64,pot::AbstractDimerPotential)
dimer_energy_update!(index::Int,dist2_mat::Matrix{Float64},new_dist2_vec::VorS,en_tot::Float64,r_cut::Number,pot::AbstractDimerPotential)
dimer_energy_update!(index::Int,dist2_mat::Matrix{Float64},tanmat::Matrix{Float64},new_dist2_vec::VorS,new_tan_vec::VorS,en_tot::Float64,pot::AbstractDimerPotentialB)
dimer_energy_update!(index::Int,dist2_mat::Matrix{Float64},tanmat::Matrix{Float64},new_dist2_vec::VorS,new_tan_vec::VorS,en_tot::Float64,r_cut::Number,pot::AbstractDimerPotentialB)</code></pre><p><code>dimer_energy_update</code> is the potential-level-call where for a single <code>mc_state</code> we take the new position <code>pos</code>, for atom at <code>index</code> , inside the current <code>config</code> , where the interatomic distances <code>dist2_mat</code> and the new vector based on the new position <code>new_dist2_vec</code>; these use the <code>potential</code> to calculate a delta<em>energy and modify the current `en</em>tot`. These quantities are modified in place and returned.</p><p>Final two methods are for use with a dimer potential in a magnetic field, where there is anisotropy in the coefficients.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ElkePahl/ParallelTemperingMonteCarlo.jl/blob/de5fd98cf5cc052a3b463e89115edde062b7b303/src/EnergyEvaluation.jl#L354-L363">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ParallelTemperingMonteCarlo.EnergyEvaluation.energy_update!-Union{Tuple{Etype}, Tuple{Etype, Config, AbstractPotentialVariables, Matrix{Float64}, Vector{Float64}, Number, AbstractDimerPotential}} where Etype&lt;:NVTVariables" href="#ParallelTemperingMonteCarlo.EnergyEvaluation.energy_update!-Union{Tuple{Etype}, Tuple{Etype, Config, AbstractPotentialVariables, Matrix{Float64}, Vector{Float64}, Number, AbstractDimerPotential}} where Etype&lt;:NVTVariables"><code>ParallelTemperingMonteCarlo.EnergyEvaluation.energy_update!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">energy_update!(ensemblevariables::Etype, config::Config, potential_variables, dist2_mat, new_dist2_vec, en_tot, pot::AbstractDimerPotential) where Etype &lt;: NVTVariables
energy_update!(ensemblevariables::Etype, config::Config, potential_variables, dist2_mat, new_dist2_vec, en_tot, pot::AbstractDimerPotential) where Etype &lt;: NPTVariables
energy_update!(ensemblevariables::Etype, config::Config, potential_variables::ELJPotentialBVariables, dist2_mat, new_dist2_vec, en_tot, pot::AbstractDimerPotentialB) where Etype &lt;: NVTVariables
energy_update!(ensemblevariables::Etype, config::Config, potential_variables::ELJPotentialBVariables, dist2_mat, new_dist2_vec, en_tot, pot::AbstractDimerPotentialB) where Etype &lt;: NPTVariables
energy_update!(ensemblevariables::Etype, config::Config, potential_variables::EmbeddedAtomVariables, dist2_mat, new_dist2_vec, en_tot, pot::EmbeddedAtomPotential) where Etype &lt;: AbstractEnsembleVariables
energy_update!(ensemblevariables::Etype, config::Config, potential_variables::NNPVariables, dist2_mat, new_dist2_vec, en_tot, pot::RuNNerPotential) where Etype &lt;: AbstractEnsembleVariables
energy_update!(ensemblevariables::Etype, config::Config, potential_variables::NNPVariables2a, dist2_mat, new_dist2_vec, en_tot, pot::RuNNerPotential2Atom) where Etype &lt;: AbstractEnsembleVariables</code></pre><p>Energy update function for use within a cycle. at the top level this is called with the new position <code>trial_pos</code> which is the <code>index</code>-th atom in the <code>config</code> it operates on the <code>potential_variables</code> along with the <code>dist2_mat</code>. Using <code>pot</code> the potential to find the <code>new_en</code>. </p><p>Has additional methods including <code>r_cut</code> where appropriate for use with periodic boundary conditions.</p><p>This function is designed as a curry function. The generic <a href="../MCRun/#ParallelTemperingMonteCarlo.MCRun.get_energy!-Union{Tuple{E}, Tuple{P}, Tuple{BC}, Tuple{N}, Tuple{T}, Tuple{MCState{T, N, BC, P, E}, AbstractPotential, String}} where {T, N, BC, P&lt;:AbstractPotentialVariables, E&lt;:NVTVariables}"><code>get_energy!</code></a> function operates on a <strong>vector</strong> of states, this function takes each state and the set potential and calls the potential specific <a href="#ParallelTemperingMonteCarlo.EnergyEvaluation.energy_update!-Union{Tuple{Etype}, Tuple{Etype, Config, AbstractPotentialVariables, Matrix{Float64}, Vector{Float64}, Number, AbstractDimerPotential}} where Etype&lt;:NVTVariables"><code>energy_update!</code></a> function.</p><ul><li>Methods defined for :<ul><li><a href="#ParallelTemperingMonteCarlo.EnergyEvaluation.AbstractDimerPotential"><code>AbstractDimerPotential</code></a></li><li><a href="#ParallelTemperingMonteCarlo.EnergyEvaluation.AbstractDimerPotentialB"><code>AbstractDimerPotentialB</code></a></li><li><a href="#ParallelTemperingMonteCarlo.EnergyEvaluation.EmbeddedAtomPotential"><code>EmbeddedAtomPotential</code></a></li><li><a href="#ParallelTemperingMonteCarlo.EnergyEvaluation.RuNNerPotential"><code>RuNNerPotential</code></a></li><li><a href="#ParallelTemperingMonteCarlo.EnergyEvaluation.RuNNerPotential2Atom"><code>RuNNerPotential2Atom</code></a></li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ElkePahl/ParallelTemperingMonteCarlo.jl/blob/de5fd98cf5cc052a3b463e89115edde062b7b303/src/EnergyEvaluation.jl#L854-L874">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ParallelTemperingMonteCarlo.EnergyEvaluation.get_new_state_vars!-Union{Tuple{N2}, Tuple{N1}, Tuple{Nang}, Tuple{Nrad}, Tuple{Any, Any, Config, NNPVariables2a, Any, Any, RuNNerPotential2Atom{Nrad, Nang, N1, N2}}} where {Nrad, Nang, N1, N2}" href="#ParallelTemperingMonteCarlo.EnergyEvaluation.get_new_state_vars!-Union{Tuple{N2}, Tuple{N1}, Tuple{Nang}, Tuple{Nrad}, Tuple{Any, Any, Config, NNPVariables2a, Any, Any, RuNNerPotential2Atom{Nrad, Nang, N1, N2}}} where {Nrad, Nang, N1, N2}"><code>ParallelTemperingMonteCarlo.EnergyEvaluation.get_new_state_vars!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_new_state_vars!(trial_pos, atomindex, config::Config, potential_variables::NNPVariables2a, dist2_mat, new_dist2_vec, pot::RuNNerPotential2Atom{Nrad, Nang, N1, N2}) where {Nrad, Nang, N1, N2}
get_new_state_vars!(indices, config, potential_variables, dist2_mat, potential::RuNNerPotential2Atom{Nrad, Nang, N1, N2}) where {Nrad, Nang, N1, N2}</code></pre><p>Function to calculate the altered state variables after an atom move: Takes the new trial<em>position, its index, the total config, the current state variables, the distance matrix and updated vector and potential values. Calculates the new cutoff function values, the updated symmetry function matrix and passes these back to potential</em>variables.</p><p>Method 2 calculates the new state variables based on an atom<em>swap. Accepts many of the same variables, but the main difference is the <code>indices</code> vector, indicating which two atoms we are swapping.  Also returns, most imporantly `potential</em>variables.new<em>g</em>matrix`.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ElkePahl/ParallelTemperingMonteCarlo.jl/blob/de5fd98cf5cc052a3b463e89115edde062b7b303/src/EnergyEvaluation.jl#L793-L803">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ParallelTemperingMonteCarlo.EnergyEvaluation.get_new_state_vars!-Union{Tuple{Nang}, Tuple{Nrad}, Tuple{Union{Vector{T}, StaticArraysCore.SVector{3, T}} where T&lt;:Number, Int64, Config, NNPVariables, Matrix{Float64}, Vector{Float64}, RuNNerPotential{Nrad, Nang}}} where {Nrad, Nang}" href="#ParallelTemperingMonteCarlo.EnergyEvaluation.get_new_state_vars!-Union{Tuple{Nang}, Tuple{Nrad}, Tuple{Union{Vector{T}, StaticArraysCore.SVector{3, T}} where T&lt;:Number, Int64, Config, NNPVariables, Matrix{Float64}, Vector{Float64}, RuNNerPotential{Nrad, Nang}}} where {Nrad, Nang}"><code>ParallelTemperingMonteCarlo.EnergyEvaluation.get_new_state_vars!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_new_state_vars!(trial_pos::PositionVector,atomindex::Int,config::Config,potential_variables::NNPVariables,dist2_mat::Matrix{Float64},new_dist2_vec::Vector{Float64},pot::RuNNerPotential{Nrad,Nang}) where {Nrad,Nang}</code></pre><p>Function for finding the new state variables for calculating an NNP. Redefines <code>new_f</code> and <code>new_g</code> matrices based on the <code>trial_pos</code> of atom at <code>atomindex</code> and adjusts the parameters in the <code>potential_variables</code> according to the variables in <code>pot</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ElkePahl/ParallelTemperingMonteCarlo.jl/blob/de5fd98cf5cc052a3b463e89115edde062b7b303/src/EnergyEvaluation.jl#L713-L716">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ParallelTemperingMonteCarlo.EnergyEvaluation.initialise_energy-Tuple{Config, Matrix{Float64}, AbstractPotentialVariables, NVTVariables, AbstractDimerPotential}" href="#ParallelTemperingMonteCarlo.EnergyEvaluation.initialise_energy-Tuple{Config, Matrix{Float64}, AbstractPotentialVariables, NVTVariables, AbstractDimerPotential}"><code>ParallelTemperingMonteCarlo.EnergyEvaluation.initialise_energy</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initialise_energy(config::Config,dist2_mat::Matrix{Float64},potential_variables::AbstractPotentialVariables,ensemble_variables::NVTVariables,pot::AbstractDimerPotential)
initialise_energy(config::Config,dist2_mat::Matrix{Float64},potential_variables::AbstractPotentialVariables,ensemble_variables::NPTVariables,pot::AbstractDimerPotential)
initialise_energy(config::Config,dist2_mat::Matrix{Float64},potential_variables::AbstractPotentialVariables,ensemble_variables::NVTVariables,pot::AbstractDimerPotentialB)
initialise_energy(config::Config,dist2_mat::Matrix{Float64},potential_variables::AbstractPotentialVariables,ensemble_variables::NPTVariables,pot::AbstractDimerPotentialB)
initialise_energy(config::Config,dist2_mat::Matrix{Float64},potential_variables::AbstractPotentialVariables,ensemble_variables::AbstractEnsembleVariables,pot::EmbeddedAtomPotential)
initialise_energy(config::Config,dist2_mat::Matrix{Float64},potential_variables::AbstractPotentialVariables,ensemble_variables::AbstractEnsembleVariables,pot::RuNNerPotential)</code></pre><p>Initialise energy is used during the MCState call to set the starting energy of a <code>config</code> according to the potential as <code>pot</code> and the configurational variables <code>potential_variables</code>. Written with general input means the top-level is type-invariant.  Methods included for:     -   Dimer Potential with and without magnetic field and with and without PBC      -   EmbeddedAtomModel      -   Machine Learning Potentials </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ElkePahl/ParallelTemperingMonteCarlo.jl/blob/de5fd98cf5cc052a3b463e89115edde062b7b303/src/EnergyEvaluation.jl#L938-L951">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ParallelTemperingMonteCarlo.EnergyEvaluation.invrexp-Tuple{Number, Number, Number}" href="#ParallelTemperingMonteCarlo.EnergyEvaluation.invrexp-Tuple{Number, Number, Number}"><code>ParallelTemperingMonteCarlo.EnergyEvaluation.invrexp</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">invrexp(r2::Number,n::Number,m::Number)</code></pre><p>Function to calculate the <code>ϕ,ρ</code> components given a square distance <code>r2</code> and the exponents <code>n,m</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ElkePahl/ParallelTemperingMonteCarlo.jl/blob/de5fd98cf5cc052a3b463e89115edde062b7b303/src/EnergyEvaluation.jl#L575-L578">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ParallelTemperingMonteCarlo.EnergyEvaluation.lrc-Union{Tuple{N}, Tuple{Int64, Number, ELJPotentialEven{N}}} where N" href="#ParallelTemperingMonteCarlo.EnergyEvaluation.lrc-Union{Tuple{N}, Tuple{Int64, Number, ELJPotentialEven{N}}} where N"><code>ParallelTemperingMonteCarlo.EnergyEvaluation.lrc</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">lrc(NAtoms::Int,r_cut::Number,pot::ELJPotentialEven{N}) where N
lrc(NAtoms::Int,r_cut::Number,pot::ELJPotentialB{N}) where N</code></pre><p>The long range correction for the extended Lennard-Jones potential (even). <code>r_cut</code> is the cutoff distance. <code>lrc</code> is an integral of all interactions outside the cutoff distance, using the uniform density approximation. Second method applies to the ELJ potential in extreme magnetic fields ELJB.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ElkePahl/ParallelTemperingMonteCarlo.jl/blob/de5fd98cf5cc052a3b463e89115edde062b7b303/src/EnergyEvaluation.jl#L469-L475">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ParallelTemperingMonteCarlo.EnergyEvaluation.set_variables-Union{Tuple{T}, Tuple{BC}, Tuple{N}, Tuple{Config{N, BC, T}, Matrix{Float64}, AbstractDimerPotential}} where {N, BC, T}" href="#ParallelTemperingMonteCarlo.EnergyEvaluation.set_variables-Union{Tuple{T}, Tuple{BC}, Tuple{N}, Tuple{Config{N, BC, T}, Matrix{Float64}, AbstractDimerPotential}} where {N, BC, T}"><code>ParallelTemperingMonteCarlo.EnergyEvaluation.set_variables</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">set_variables(config::Config{N, BC, T}, dist_2_mat::Matrix{Float64}, pot::AbstractDimerPotential) where {N, BC, T}
set_variables(config::Config{N, BC, T}, dist2_matrix::Matrix{Float64}, pot::AbstractDimerPotentialB) where {N, BC, T}
set_variables(config::Config{N, BC, T}, dist2_matrix::Matrix{Float64}, pot::EmbeddedAtomPotential) where {N, BC, T}
(set_variables(config::Config{N, BC, T}, dist2_mat::Matrix{Float64}, pot::RuNNerPotential{nrad, nang}) where {N, BC, T}) where {nrad, nang}
(set_variables(config::Config{N, BC, T}, dist2_mat, pot::RuNNerPotential2Atom{nrad, nang, n1, n2}) where {N, BC, T}) where {nrad, nang, n1, n2}</code></pre><p>Initialises the PotentialVariable struct for the various potentials. Defined in this way to generalise the <a href="../MCStates/#ParallelTemperingMonteCarlo.MCStates.MCState"><code>MCState</code></a> function as this must be type-invariant with respect to the potential. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ElkePahl/ParallelTemperingMonteCarlo.jl/blob/de5fd98cf5cc052a3b463e89115edde062b7b303/src/EnergyEvaluation.jl#L992-L999">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ParallelTemperingMonteCarlo.EnergyEvaluation.swap_energy_update-NTuple{6, Any}" href="#ParallelTemperingMonteCarlo.EnergyEvaluation.swap_energy_update-NTuple{6, Any}"><code>ParallelTemperingMonteCarlo.EnergyEvaluation.swap_energy_update</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">swap_energy_update(ensemble_variables,config,potential_variables,dist2_matrix,en_tot,pot)</code></pre><p>This is used as a replacement for the energy<em>update! function when swapping atoms. It does not function in quite the same way, but stands as a replacement. First calculates `get</em>new<em>state</em>vars!<code>and then</code>calc<em>new</em>runner<em>energy!` returning the new</em>energy.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ElkePahl/ParallelTemperingMonteCarlo.jl/blob/de5fd98cf5cc052a3b463e89115edde062b7b303/src/EnergyEvaluation.jl#L839-L842">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../CustomTypes/">« CustomTypes</a><a class="docs-footer-nextpage" href="../Ensembles/">Ensembles »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.1 on <span class="colophon-date" title="Wednesday 26 February 2025 04:53">Wednesday 26 February 2025</span>. Using Julia version 1.11.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
