include("/Users/tiantianyu/Downloads/ParallelTemperingMonteCarlo.jl-2/CNA/CNA.jl")
include("/Users/tiantianyu/Downloads/ParallelTemperingMonteCarlo.jl-2/CNA/comparison.jl")

using .CommonNeighbourAnalysis
using .Comparison
using Graphs


x38_0=[0.1947679907,        0.3306365642,        1.7069272101,1.1592174250,       -1.1514615100,       -0.6254746298,1.4851406793,       -0.0676273830,        0.9223060046,-0.1498046416,        1.4425168343,       -0.9785553065,1.4277261305,        0.3530265376,       -0.9475378022,-0.6881246261,       -1.5737014419,       -0.3328844168,-1.4277352637,       -0.3530034531,        0.9475270683,0.6881257085,        1.5736904826,        0.3329032458,-1.1592204530,        1.1514535263,        0.6254777879,0.1498035273,       -1.4424985165,        0.9785685322,-1.4851196066,        0.0676193562,       -0.9223231092,-0.7057028384,        0.6207073550,       -1.4756523155,-0.8745359533,        0.4648140463,        1.4422103492,-0.9742077067,       -0.8837261792,       -1.1536019836,-0.1947765396,       -0.3306358487,       -1.7069179299,0.3759933035,       -1.7072373106,       -0.0694439840,-1.7124296000,        0.3336352522,        0.1307959669,0.9143159284,        1.3089975397,       -0.7151210582,-0.3759920260,        1.7072300336,        0.0694634263,1.7124281219,       -0.3336312342,       -0.1308207313,-0.9143187026,       -1.3089785474,        0.7151290509,0.9742085109,        0.8837023041,        1.1536069633,0.7057104439,       -0.6206907639,        1.4756502961,0.8745319670,       -0.4648127187,       -1.4422106957,-1.1954804901,       -0.6171923123,       -0.1021449363,0.0917363053,       -1.0144887859,       -0.8848410405,0.9276243144,       -0.8836123311,        0.4234140820,1.1954744473,        0.6171883800,        0.1021399054,-0.9276176774,        0.8836123556,       -0.4234173533,-0.3595942315,       -0.4863167551,        1.2061133825,0.3595891589,        0.4863295901,       -1.2061152849,-0.0917352078,        1.0144694592,        0.8848400639,0.6410702480,       -0.1978633363,       -0.3898095439,-0.4162942817,       -0.0651798741,       -0.6515502084,0.1334019604,        0.7474406294,       -0.1600033264,-0.6410732823,        0.1978593218,        0.3898012337,0.4162968444,        0.0651733322,        0.6515490914, -0.1333998872,       -0.7474445984,        0.1600019961]

N=38

x38_1=[1.008361125057741, -0.769633980599810, -0.559171817871104, -0.509096148186660,   1.089162554039077,   1.493257400206362,-0.509096148167876,  -1.083602442204281,  -1.497297057921385,-0.094670886737197,  -0.752474668428163,   0.546704847883737,-0.094670886726391,   0.287419747651941,  -0.884587025672089, 0.437484411864528,   0.587876417632846,   1.809297572314977,-0.509096148166006,   1.089162553975334,  -1.493257400259897,-0.509096148182748,  -1.758865693549359,   0.567876927204396,-1.051607156787838,  -0.983328451416249,   0.000000000013715,-1.051607156782287,   0.795529428237470,  -0.577985961926859, 1.008361125048545,   0.293974021705785,   0.904759006905073,-1.051607156790282,   0.795529428262142,   0.577985961878354,-1.051607156780777,  -0.303865202559347,  -0.935200931379506, -1.051607156793712,  -0.303865202519426,   0.935200931377932, 0.433986584080560,  -0.477568670182377,  -1.469805233980068, 0.433986584078187,   1.250291010396660,  -0.908389591474013,-0.094670886738626,   0.287419747689702,   0.884587025658510, 1.008361125061060,   0.293974021667163,  -0.904759006903675, 1.008361125055377,   0.951319917798398,  -0.000000000013331, 0.437484411867450,  -1.539080442423734,   1.118207395495087,-0.509096148171778,   1.756741919810773,  -0.574413230685629, 0.437484411889554,   0.587876417555611,  -1.809297572334021, 0.437484411882917,  -1.539080442471467,  -1.118207395423336, 1.584073743697131,  -0.000000000001384,   0.000000000010955, 0.437484411878189,   1.902408049704833,  -0.000000000037579, 0.470745098913714,  -0.000000000000411,   0.000000000003256,-0.509096148188586,  -1.083602442140365,   1.497297057960599, 0.433986584069463,  -1.545444680531982,   0.000000000035987, 0.433986584065622,   1.250291010435437,   0.908389591426644,-0.509096148164505,  -0.003436338133663,  -1.848264300362580,-0.509096148179723,   1.756741919835293,   0.574413230603596,-0.509096148174893,  -1.758865693573600,  -0.567876927136356, 0.433986584060231,  -0.477568670119635,   1.469805234006457,-0.509096148190070,  -0.003436338054765,   1.848264300355686,-0.094670886729635,  -0.752474668451500,  -0.546704847852925,-0.094670886731947,   0.930109841538431,  -0.000000000020507, 1.008361125050007,  -0.769633980575941,   0.559171817917904,-0.631627748248736,   0.000000000000551,  -0.000000000004368]

energies=Array{Float64}(undef,1000)
similarity=Array{Float64}(undef,1000)
config_1=Array{Float64}(undef,N,3)
for i=1:N
	for j=1:3
		config_1[i,j]=x38_0[3i-(3-j)]
	end
end

totalProfile_global = Dict{String,Int}() 
atomicProfile_global = [Dict{String,Int}() for i in 1:N]

totalProfile_global = CNA(config_1, N, 1.3549, true, 1.)[1]
atomicProfile_global = CNA(config_1, N, 1.3549, true, 1.)[2]

println(totalProfile_global)
println(atomicProfile_global)

#open("1000_cluster_energies.txt") do f
    #for i=1:1000
        #line=readline(f)
        #energies[i]=parse(Float64, line) 
    #end
#end

#println(energies)

open("1000_clusters.xyz") do f
    for i=1:1000
	    configuration = Array{Float64}(undef,N,3) # Initialise 3D array for the atom coordinates for each configuration in the file.
	    totalProfiles = Array{Dict{String,Int}} # Initialise array to hold total CNA profiles
	    atomicProfiles = Array{Dict{String,Int}} # Initialise array to hold atomic CNA profiles
	    bondGraphs = Vector{SimpleGraph}() # Initialise vector of graphical representation of each configuration.
        for j=1:2
            line = readline(f) 
        end
        #println()
        atomNum = 0
        for j=1:38
            line = readline(f) 
            for (k,x) in enumerate((split(line, r" +"))[2:4]) # For each component of the coordinate
				configuration[j,k] = parse(Float64,x) # Store the component
			end
        end
        #println(configuration)
        totalProfiles = CNA(configuration, N, 1.3549, true, 1)[1]
        atomicProfile_global = CNA(configuration, N, 1.3549, true, 1)[2]
        #println(totalProfiles)
        #println(atomicProfiles)
        similarity[i]=similarityScore_one(1, 2, [totalProfile_global,CNA(configuration, N, 1.3549, true, 1)[1]],[atomicProfile_global,CNA(configuration, N, 1.3549, true, 1)[2]],"total",N,)
    end
end

println(similarity)
