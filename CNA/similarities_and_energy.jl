# Read atomic coordinates from a file and find their energy & similarities to certain minima

include("/Users/tiantianyu/Downloads/ParallelTemperingMonteCarlo.jl-2/CNA/CNA.jl")
include("/Users/tiantianyu/Downloads/ParallelTemperingMonteCarlo.jl-2/CNA/comparison.jl")

using .CommonNeighbourAnalysis
using .Comparison
using Graphs

#13 atom ico
x13_0=[2.825384495892464, 0.928562467914040, 0.505520149314310, 2.023342172678102, -2.136126268595355, 0.666071287554958, 2.033761811732818, -0.643989413759464, -2.133000349161121, 0.979777205108572, 2.312002562803556, -1.671909307631893, 0.962914279874254, -0.102326586625353, 2.857083360096907, 0.317957619634043, 2.646768968413408, 1.412132053672896, -2.825388342924982, -0.928563755928189, -0.505520471387560, -0.317955944853142, -2.646769840660271, -1.412131825293682, -0.979776174195320, -2.312003751825495, 1.671909138648006, -0.962916072888105, 0.102326392265998, -2.857083272537599, -2.023340541398004, 2.136128558801072, -0.666071089291685, -2.033762834001679, 0.643989905095452, 2.132999911364582, 0.000002325340981, 0.000000762100600, 0.000000414930733]

x38_0=[0.1947679907,        0.3306365642,        1.7069272101,1.1592174250,       -1.1514615100,       -0.6254746298,1.4851406793,       -0.0676273830,        0.9223060046,-0.1498046416,        1.4425168343,       -0.9785553065,1.4277261305,        0.3530265376,       -0.9475378022,-0.6881246261,       -1.5737014419,       -0.3328844168,-1.4277352637,       -0.3530034531,        0.9475270683,0.6881257085,        1.5736904826,        0.3329032458,-1.1592204530,        1.1514535263,        0.6254777879,0.1498035273,       -1.4424985165,        0.9785685322,-1.4851196066,        0.0676193562,       -0.9223231092,-0.7057028384,        0.6207073550,       -1.4756523155,-0.8745359533,        0.4648140463,        1.4422103492,-0.9742077067,       -0.8837261792,       -1.1536019836,-0.1947765396,       -0.3306358487,       -1.7069179299,0.3759933035,       -1.7072373106,       -0.0694439840,-1.7124296000,        0.3336352522,        0.1307959669,0.9143159284,        1.3089975397,       -0.7151210582,-0.3759920260,        1.7072300336,        0.0694634263,1.7124281219,       -0.3336312342,       -0.1308207313,-0.9143187026,       -1.3089785474,        0.7151290509,0.9742085109,        0.8837023041,        1.1536069633,0.7057104439,       -0.6206907639,        1.4756502961,0.8745319670,       -0.4648127187,       -1.4422106957,-1.1954804901,       -0.6171923123,       -0.1021449363,0.0917363053,       -1.0144887859,       -0.8848410405,0.9276243144,       -0.8836123311,        0.4234140820,1.1954744473,        0.6171883800,        0.1021399054,-0.9276176774,        0.8836123556,       -0.4234173533,-0.3595942315,       -0.4863167551,        1.2061133825,0.3595891589,        0.4863295901,       -1.2061152849,-0.0917352078,        1.0144694592,        0.8848400639,0.6410702480,       -0.1978633363,       -0.3898095439,-0.4162942817,       -0.0651798741,       -0.6515502084,0.1334019604,        0.7474406294,       -0.1600033264,-0.6410732823,        0.1978593218,        0.3898012337,0.4162968444,        0.0651733322,        0.6515490914, -0.1333998872,       -0.7474445984,        0.1600019961]
x40_0=[  1.3996290196,       -0.5560532055,       -1.4535693513, -0.1739285129,        1.2573515683,        1.5497711912, -1.8366378471,        0.7895745681,        0.1277111801,  1.3783699998,       -0.3429543155,        1.3510982611, -1.3139895628,       -1.1004085519,       -0.9515874810,  0.6770575455,       -1.7982560111,       -0.2001097016, -0.7825414061,       -0.8572206925,        1.1969439674,  0.7153058157,        0.8678511380,       -1.1218245188,  0.7633014209,        1.4625516139,        0.9736889382, -1.4541932117,        0.8386937304,       -0.9228597544, -0.2518232102,        1.8200097191,        0.5840504238, -1.0910110996,        1.5839166521,       -0.1336772443,  1.5460676265,        0.6546269631,        0.8692312598, -1.1863083606,       -0.1140837198,       -1.4676794502,  1.8169606389,       -0.3136289307,        0.3230386912, -0.3977483453,       -0.9367004379,       -1.5711299115,  1.4629996112,       -1.0467172434,       -0.4567826480,  0.6037943559,       -1.2884405719,       -1.1916332142, -1.0093060809,        1.0289357797,        0.8416433576, -1.5824215251,       -0.1559753016,       -0.4150534222,  0.6060819352,        0.4597266224,        1.4566983795, -0.3196369478,       -1.4560285544,       -0.5779820974,  1.0319327510,       -1.0757856000,        0.5779706456,  0.2988451253,       -0.6011931031,        1.2767686860, -1.0506150258,       -0.9808426066,        0.1226203280, -0.4789518255,        0.2010028277,        1.3758462670, -1.3121561461,       -0.0334074884,        0.6632347259, -0.0413968213,        1.3471887778,       -0.3947469296, -0.0518679078,       -1.3296620805,        0.4980279652, -0.4022417262,        0.6105362714,       -1.1761073669,  0.9634290062,        0.9947465394,       -0.0080933199,  0.3717057127,       -0.2041778853,       -1.2789168265,  1.2327895460,        0.0380739120,       -0.5424587583,  0.2177772620,        0.3111101070,       -0.3569700621, -0.7896824028,        0.5415368575,       -0.1163218463,  0.0241941804,        0.7705101067,        0.5797606897, -0.5340348779,       -0.3832743671,       -0.6436325489,  0.7830102273,       -0.0127451068,        0.4827924283,  0.4432248256,       -0.7231377271,       -0.2803588276, -0.2759837620,       -0.2672502533,        0.4105978953]
x40_fcc=[2.155369100064665, -1.8274976614222727, -3.645506484860948, -0.03852954264161997, 3.382165268508419, -0.373180951717705, 4.468230383540518, -2.5792134679782404, 1.1443174990579135, 3.4401572327035588, 2.2395645239964184, 1.5861567290640235, -0.6059382389395596, -2.4250782041102865, -3.2338104587443453, 3.7471702155282576, -0.8437265118378005, -1.2537451559677064, -4.569007239225559, -2.6554046676245973, 0.006095986923919224, 2.5686366436611126, -0.47045619976430564, 1.5660731677789481, -5.269232378451845, -0.9213900033404425, -2.412829800993764, 3.03271661879615, 0.8863030480816038, -3.6456615931665683, 0.09775351086283338, -4.143360378002687, -0.8250853377235139, 5.345813857427581, 0.1405804107918241, 1.1405966321162475, -4.385792212126661, 1.799603992144588, -2.413487634508845, -0.19646925342201502, -1.064298362070737, 1.9662660125925806, 4.620937731479326, 1.8903129918984174, -1.2604152238543795, 0.9791419555609401, -1.4457644712452364, -0.8340226799992518, 1.2711999212595857, -4.539121189683478, -3.6463779187015044, -1.785165326688557, -2.0409209852287113, -0.4325786341987575, -3.6748767536333906, 0.0650009431821077, -0.011599108119511188, 3.5793356385432786, -5.29536533187355, 1.1407955864021033, 1.966464183813616, -6.284935330798038, -1.261198638809168, 1.8504579425394128, 1.2547937445375086, -0.8245411084952374, 2.7243825986843895, 3.9889000231755567, -0.7972547892801488, -2.9615189504401496, -1.6662365547168132, 2.3829366546706154, -2.6799384872861105, -4.756050652338954, -0.3737880574430301, 0.8038712275101637, -5.874438396388076, 1.5852052884230297, 1.154733802163165, 2.9933750083311383, -3.214115227045395, -1.6088888768159286, 2.3908041482648894, -2.824828531752337, -0.9084519708128906, 0.6593805069218278, -0.43237157619373007, 0.2717564283021242, 0.27824102363039804, -3.2335358849008955, -2.8012620876664815, 2.791822480917754, 0.005833308758272821, -0.8005512178504812, -6.869844232676485, -0.8005838854457046, 0.6790792075450789, 1.6418176772550872, 1.9842403334497485, -2.4923734838387785, -0.3187498285041794, -2.831758763030737, -2.0798016267235826, 1.0478595413775031, 2.38294554873261, -1.078470372034238, -3.768165899855633, 1.9841597853737336, 2.8654120870560296, -3.5591537673241342, -1.254091634067672, -1.486373307598398, -5.140939805389835, -3.2152894626001625, -3.368984254216907, -3.0304891191988066, -2.8246268560572267, 1.6916428901104283, -3.1695141959094126, 1.5659372146819373]

x44_0=[-0.8830639892,       -0.6448464080,        1.7261720130,      1.2930242328,       -0.0434275342,        1.6346293616,      1.4570865752,        1.0220948884,        1.3294054671,     -1.2333078209,       -1.4455844471,       -0.9538183073,      0.7783508601,       -0.8389752201,       -1.7376911073,     -1.9697195260,        0.1880930800,        0.3951044968,      1.2756330753,        1.1682931755,       -0.8884762440,     -0.4252115672,        1.8064415632,        0.4271099278,     -0.8273674350,        0.6862472977,       -1.4575711761,      0.7084006678,       -1.5878321917,       -0.9091597887,     -0.3043294977,       -1.8924759532,       -0.5115270847,      1.8513169884,        0.1978531398,        0.6739448021,     -1.1761695772,       -1.5697291775,        0.1577334524,      1.5000867979,       -0.7584067466,       -0.8802520715,      0.4593289929,        0.7190606541,        1.7503236151,     -1.5447222691,       -0.7473478819,        0.8353759300,     -1.2837604638,        0.2908727418,        1.2741748786,      1.7495584386,        0.2530322882,       -0.4438977582,     -0.4963071025,        1.0987763970,        1.2934966804,      0.6036007681,       -0.7259279920,        1.0925118315,     -0.2289563456,       -1.1482330254,       -1.3533072483,      1.3711671224,        1.0998720151,        0.2188944760,     0.5157195530,        1.4194804107,        0.8804456684,      1.0344053890,        0.1654596642,       -1.3175656737,     -1.6103686415,       -0.6304957635,       -0.2812711236,     -1.2021504321,        1.0027134987,        0.4146039602,     -1.0326670215,       -0.3802480389,       -1.2085467625,     -0.0238583263,       -0.0765186976,       -1.6021193211,     -0.6280935569,        1.2506740184,       -0.5170956228,      0.2249903867,        0.9302374598,       -1.1768667535,     -1.4020908089,        0.4383748044,       -0.5310599332,      0.4261133145,        1.4937290710,       -0.2326270355,      0.3974835900,       -1.3077422257,        0.1146507117,     -0.4622765865,       -0.9924851629,        0.7689449985,      1.1726884324,       -0.4900186055,        0.1393971183,     -0.2081152672,        0.0402438415,        1.1996805631,      0.1313398466,       -0.2811467256,        0.2428851132,      0.7782538726,        0.3589708695,        0.7706124714,     -0.5384497465,       -0.8473652127,       -0.3455325803,      0.4459136808,       -0.5506048584,       -0.7290751719,     -0.8979454649,       -0.0495383504,        0.3184725059,      0.6900936005,        0.4328245017,       -0.3156020756,     -0.1444304279,        0.7461175628,        0.3294020420, -0.3411943112,        0.1994872754,       -0.5949092453]
x44_dec=[5.145116356697821, -2.4649219164309746, 1.2654727298755382, 0.1622572727026579, 1.2405236267806146, 5.99069634670563, -3.758491395443792, 0.3387841014563388, -0.3076663479747811, 3.859511493199989, -0.3256471552663303, -0.2988280229601574, -4.363098017869619, 3.1626436123606134, 2.8235683824556577, 3.858038474697607, -0.3265140321299173, 2.828573260394468, -3.066883126614657, -2.468397201817178, 2.833819367324265, -2.086812975169696, 2.1965619222320676, -1.8573207456538816, -1.4343710311064406, -0.5945739333650397, 1.26218957547317, 0.5955341472925253, 6.137110937678793, -0.2886019465362109, -1.705534039288746, 7.157286924417739, 1.26432257098735, 2.790082118468133, 4.258615810918307, -0.29524659846506046, -1.893767118084052, 4.670678675973042, -0.29704279469807443, 0.3769288192222377, 3.6698990983035644, 1.2644534471323223, 0.16403183552468067, 1.2439610357927393, 2.825872873497735, 0.1652884476708362, 1.244702858975366, -0.29883969131088584, -1.8952950077980488, 4.669711614490822, 2.8244434103311433, 0.5941241311006147, 6.136212292329383, 2.8196204947024976, 4.956809477498261, 2.341302173370073, -0.2949727434498327, 2.548620349857529, 1.7898908012648767, -1.8565676234569055, 4.955711428034227, 2.34004991681997, 2.826415673592502, -4.3615438173614, 3.164004902807327, -0.3002849038053457, -1.4416803595589303, -0.6026668465431047, 4.380502979066816, -4.174093926308389, 5.67681970321025, 1.2628637362391806, 2.684362466575059, -2.979154496349827, 2.8274862414352633, 0.3792049415262701, 3.6793887887816386, -1.8575812632363358, -3.759570220966126, 0.3375008282728246, 2.8308378308509825, -0.1915723331350119, -2.7662385272414296, -0.30672205303067857, 2.7888976199233997, 4.257809917460293, 2.826871154455954, 5.209618044086324, 4.84899886903339, 1.2673155662315463, 3.0384342839396585, 6.7395893927990915, 1.266897733917757, 2.5369615272126427, 1.7885871380966833, 1.2646677169317235, -2.079674141173549, 2.191845077795451, 1.262711629512259, -0.1925622526106648, -2.7670273710270084, 2.830770323806428, 1.4227613283598817, -0.8544877714438557, -1.8535407896771516, 0.3767122884407407, 3.6777278594097527, 4.386589310726146, 1.4183965563474692, -0.8471161598624029, 1.2635247212552145, 1.420301229910975, -0.8559237914027589, 4.380640774638101, -1.4393623985723352, -0.6006613954906614, -1.8561501897891015, -2.089391355235397, 2.194838993760245, 4.382741992489269, 2.6857288035557865, -2.9783034757903777, -0.30024743747247856, 0.1661316170806198, 1.24291914425561, -3.463572256568959, 2.5461822711267157, 1.7883415747860225, 4.385993853444721, -3.0661786160630298, -2.466656339797792, -0.3128097158621816]

x45_0=x45_0=[1.3572700152,        1.5176045871,        0.2862467591,  1.1230373217,        1.4146322341,       -0.8407205821,  0.2168084332,        1.1779188049,        1.8318746067,   0.3344771278,       -1.1531656064,       -1.7774655304,  0.0017017023,       -2.1045599341,        0.2324981174, -0.5324839479,        0.9106999176,       -1.7153308567, -1.0707286731,       -0.6265016039,        1.5267517038, -1.4222114067,        1.2263955780,        0.3169059515, -1.5549021382,       -0.7746486095,       -0.6538335418,  1.1910338147,        1.0305323350,        1.2972681082,  1.0106173186,       -1.6996388968,       -0.0336829343,  1.1781312633,       -1.2207228413,       -1.0441271851,  1.0092881793,       -0.2625470553,       -1.6536906609,  0.6766312556,        0.1520752037,        1.8276802370,  0.5678831631,       -1.5228419006,        1.0110012581,  0.5784221359,        0.7833904052,       -1.6100972078,  0.0350477941,       -0.7654418267,        1.6624349486,  0.3838146864,        1.6691322386,        0.8346216565,  0.0114547519,        1.5300780042,       -0.9587933155, -0.4348329951,        1.6882825323,        0.0665981764,  0.1666568136,       -1.6398913336,       -0.7779600523, -0.4294134221,        0.2741957067,        1.6878216672, -0.0988121339,       -0.1192081370,       -1.7558398966, -0.5366411033,       -1.3712357594,        0.8867916310, -0.6062156823,        1.2047247866,        1.0784542778, -0.9825869302,        1.0739439818,       -0.7025788743, -0.6121018431,       -0.9658011112,       -1.2196926137, -0.7790918819,       -1.4437930165,       -0.2103456378, -1.4946505196,        0.2265043740,       -0.1691881922, -1.0489226483,        0.0686431095,       -1.1899663240, -1.2533630859,        0.3007121266,        0.9264128357, -1.3192247037,       -0.7038396686,        0.4386279006,  1.2758268292,        0.4171732949,        0.3802938355,  1.2069451668,       -0.6147585026,       -0.1191643402,  1.0381754830,        0.3228086229,       -0.7188097331,  0.7683763986,       -0.4431759740,        0.9036369653,  0.3527232373,        0.0092204239,        0.0327160195,  0.4465088661,        1.0560905635,       -0.0725095550,  0.2824088148,        0.5818073318,        0.9118121867,  0.3397164670,       -0.5601827806,       -0.8530162251,  0.1771565305,       -1.0250268621,        0.1295112686, -0.0866629892,        0.4509625213,       -0.8235440635, -0.3504498583,       -0.3019838767,        0.7635617925, -0.5261113232,        0.6052917403,        0.1709667982, -0.5907062840,       -0.3738551277,       -0.3041313794]
x45_dec=[2.2310222291467925, -0.34136917475242645, -4.297721456434558, 4.662934998068595, -0.5194289080946113, 0.4035794671890698, -2.0731697932685096, 1.41501469366902, -4.3340426676053845, -0.26185069258658494, -0.16143501224950613, 3.528415673155491, -3.8425130795886693, -5.2078481194274, -1.2252045976543748, 3.2026729855013736, 1.9572538171640126, -2.740006570655201, -2.3299279164279794, -1.451242925939545, 1.9069439421610013, -0.21974849787515097, -0.16753444767286402, -2.760829988671221, 0.672059291609979, 2.101272057996117, 1.9250499497683826, 2.187503140974531, -0.33726759414160157, 1.9404524658604434, 2.8360754066509792, -2.7450213336934604, -2.7314392860444237, 0.6905158271491886, 2.091309137367575, -1.1924189209909997, -1.1779458161001066, 3.7452886995156005, -2.7784984877601007, 0.3329216194322549, -2.537540766131323, 1.929304810024711, -1.1761540655616842, -6.295788417863091, -1.2033516941069522, -1.2002432034079844, 3.7471052574133092, 0.3596519679219486, -4.205990293474064, 0.12871368207110448, -2.792442912449475, -2.1165485172695897, 1.418615832505341, 1.9044204269881322, -3.9939697313161675, 3.0124128036865305, 0.3299370821266832, 3.1801152514158595, 1.9599504654897917, 0.3979657324760141, 0.7155858836286609, 2.0973826880399953, -4.309667992734533, 5.307802986039326, -2.960778798646205, -1.1490770069208314, -0.19696526236292988, -0.1667639101178969, -5.925465483806411, 0.9319691924698205, -4.934905737366275, 0.3679687918182086, 1.6403491055193622, 4.389406622858879, -2.7592621079549433, -2.0870710397885768, 1.4109868649487503, -1.214845036300549, 1.6174093855084313, 4.391967015204117, 0.3873923739290557, -0.24152780854492484, -0.16566145061624166, 0.36367646476903537, -3.971926797261406, 3.0105922787025947, -2.793353839715825, 4.685119728988108, -0.522457937419905, -2.7195933888043853, -4.416097403712814, -2.752965849762066, 0.3222557701458584, 0.9533513765856009, -4.936812402039908, -2.739337544270776, -2.286768095876911, -1.4544469060349652, -4.336351434632776, -6.14241750855485, 1.7115955361406134, -1.2495578592645802, 3.4494274151409954, -5.158946145215569, -1.1633195783936223, 0.3759893283495269, -2.541283109211812, -4.313859013965392, -1.751107635692978, -3.8663707781187058, 0.3512213166058446, -1.729731597269088, -3.8680429449063003, -2.7690765489778375, -6.352454245030579, -1.1590495756218435, -1.2495308030739691, -4.394574368354648, -2.7542496224175896, -2.7851695050304626, 0.35210817459174065, -2.530326972317492, -1.1922929404203773, -4.227502364468037, 0.1303286028088916, 0.32814521708820327, 2.8142475467387706, -2.7427952216110767, 0.3892846574169176, 2.199695267798542, -0.3382303045449933, -1.1786984142974302, -2.300364769435129, -1.4480335310087376, -1.2146767239347973]

x51_0=[0.2776107952,       -0.2279442855,       -2.1138503007,1.4386195957,        1.2153388252,        1.0250322288,-0.1390164391,        0.0623149810,        2.1387274209,-1.2999804269,       -1.3809908046,       -1.0001412812,0.6293336721,        1.7023702520,       -1.0155562931,-1.9196817051,       -0.1606225160,        0.7838931625,-0.7284119762,        1.7418780211,        0.7715235968,-1.4433806010,        0.8530704643,       -1.1614118578,1.2471680074,       -1.4901539036,        0.2239075829,1.4856875973,       -0.9738657285,       -0.7657941032,0.5565509226,       -1.4662782843,        1.1324314181,0.1922085096,       -1.9192306294,        0.1473347894,1.8500289792,       -0.5209185161,        0.2193051316,1.5289773959,        0.0983280317,        1.1204410839,0.7320293977,       -0.4841245129,        1.6830283896,-0.2178024897,       -1.6649543067,       -0.8850468618,0.5791184419,       -1.0824866415,       -1.4476410255,1.7679426905,        0.6114441706,        0.1349253162,-0.9048076657,       -1.6427471502,        0.0200331511,1.1808447275,       -0.1183750674,       -1.4523366282,-0.3177473654,       -0.9128985132,        1.6072751137,1.3582714771,        0.8565099844,       -0.8962300357,-1.2168064575,       -1.0255330678,        0.9216183994,-0.5146822165,       -0.8101434880,       -1.5678246096,0.6543909405,        0.6432010461,        1.5929070599,-1.0371564481,       -0.0495172184,        1.4714709093,1.0411882279,        1.4694551550,        0.0043006720,0.4567668430,        0.7429699820,       -1.5756702149,-1.6215403872,       -0.7760267592,       -0.1084955321,-0.4367628714,        0.9082882839,        1.4642443480,-0.5869950184,        0.3149329816,       -1.6480288891,0.3569397560,        1.4883667402,        0.9039451807,-1.3806739524,       -0.2651601496,       -1.0877278134,-1.6929305925,        0.3485289839,       -0.1902961957,-0.0498662259,        1.7338378787,       -0.1225790317,-0.4099388216,        1.2862428855,       -1.0960131593,-1.3328735507,        0.7961379571,        0.7831352444,-1.0934438399,        1.3064937381,       -0.1962977565,0.0824426867,       -0.0985050383,        0.0148014164,0.8300764037,       -0.5570331150,        0.5991584231,0.4734221882,       -1.0004242569,       -0.3651391989,-0.2026966607,       -0.9780691041,        0.5247016336,1.0646434745,       -0.0518087550,       -0.3699672896,-0.0276577024,       -0.0187400216,        1.0565988277,0.1775967920,       -0.1604228417,       -1.0296839008,-0.5970391790,       -0.7265934098,       -0.4828236244,0.7470001597,        0.5474229837,        0.5097415725,-0.9013671160,       -0.1273567178,        0.3919514584,0.3494388851,        0.7868225363,       -0.4910418497,-0.6677829594,        0.3706057311,       -0.5622588569,-0.3172558981,        0.8063631898,        0.3854227791]

x78_0=[1.8422213287,       -0.9366704678,       -1.5708104047, -0.2888637974,       -0.7985940393,       -2.3072363694,  1.7829473339,       -1.5859183317,        0.5920274122, -1.4891474753,       -1.6489756657,        1.3334611195, -2.1360175089,       -1.4031522570,        0.4282433810,  1.9387150989,       1.6592230649,        -0.2184744819,  1.2925302707,        1.9047828400,       -1.1227365528, -0.7118946159,       -1.2108075395,        2.0860326659, -2.4313032975,       -0.5573988825,       -0.3200762464,  1.9117626747,        1.3209814484,        0.8975570505,  0.1933845147,        1.9739910879,       -1.5071164245,  -0.1291687801,       -0.2699829989,        2.3711869259, -2.2509614682,        0.5363377352,       -0.5980104851, -0.9015621153,        1.8378856666,       -1.2083836378,  1.2198105800,        1.0317308925,        1.7602333754,  0.1035611669,        0.8451331746,        2.0799629617, -1.6323938750,        1.5048250721,       -0.3493028601, -1.1750951215,       -0.2054007400,        1.9907410011, -2.2636800730,        0.2082823271,        0.4673957049, -0.9577378624,        0.9251329394,        1.7188879341, -1.6642729300,        1.1936279052,        0.7301754371, -0.8959832066,        1.9347740276,        0.3826400529, -0.1896470156,        1.6663549783,        1.3710742069,  0.9332702108,        1.8291253425,        1.0361494126, -0.1549119414,        2.2426513281,       -0.4866370150, -1.9623234599,       -0.6469183159,        1.2266008349,  0.9579998420,        2.1715232503,       -0.0948913222, -0.0044764979,       -1.6310608403,       -1.6038383295,  1.0455999883,       -2.0301081246,       -0.1343758796,  1.0788589077,       -1.7000804467,       -1.2326248275, -0.0579388103,       -2.1481783751,        0.1752180569, -0.7048651428,       -1.9023338072,       -0.7300804724, -1.6635859911,       -1.3280052339,       -0.5830855573, -0.3905734859,       -1.8117742038,        1.1983460187,  2.0983691450,        0.5907623278,        0.0697419204,  0.8275588305,        1.0736896648,       -1.7086120834,  1.8274408425,       -1.2682630749,       -0.4910008927,  0.7817034575,       -0.8708652785,       -1.9543911840,  -0.9889114893,       -1.0728225035,       -1.4572924435,  0.7002882260,       -1.7147494049,        0.9065478291,  1.9884871496,       -0.1705273000,       -0.7550210578,  1.3459979817,        0.0736290196,       -1.6541117531,  0.2719409498,        0.1424521039,       -2.0253620668,  1.9585110092,       -0.4984724075,        0.3348017448,  1.2757912482,       -0.7842212185,        1.1907445446, -0.8127942751,        0.0094774795,       -1.7319911115,  0.7537661072,        0.0194122684,        1.7556048738,  -1.3109953289,        0.8040556744,       -1.1337874946, -1.0369778463,       -1.5786560688,        0.3123227353,  1.4716800523,        0.8413046427,       -0.8231981009,  -1.5020558249,       -0.2584812131,       -0.8603831657,  0.1789610982,       -0.8972975888,        1.4920026352,  1.4332829331,        0.3138289401,        0.9235463894, -0.2468204331,        0.9522945566,       -1.4275645738, -1.3336343927,        0.1970462533,        1.0065272253,  0.1423720711,        1.6208475263,        0.3384168151,  0.2385093605,       -0.4061786924,       -0.2807406366,  0.2611281383,       -1.4171655247,       -0.5714482467,  1.0253910161,       -0.6644181754,       -0.9131723814, -1.4942519757,       -0.5585930766,        0.2209650999, -0.8672066434,       -0.7968820654,        1.0984413564,  1.1087586894,        1.1103073812,        0.2036268604,  0.4823490421,        1.3483525207,       -0.6729614530,  -0.0220855163,       -0.5971068955,       -1.2757172933,  0.9966391347,       -0.9842398054,        0.1498713349, -0.3030256527,        0.1072230524,        1.3760389632, -1.3226791165,        0.4947090730,       -0.0508470433, -0.5736957626,        1.2171417663,       -0.3896902164,  0.4457786378,        0.8297246671,        1.0369456130, -0.6001838360,        0.9161827365,        0.6776905983, -0.0656358670,       -1.1002017096,        0.4440364155, -0.6933739546,       -0.8616495883,       -0.4344097734,  0.5285136574,        0.3182556388,       -0.9861208782,  1.1553186612,        0.0800598447,       -0.1089789080,  0.4955368815,       -0.1989753755,        0.7212494148, -0.5232285910,        0.1881725188,       -0.7043943693, -0.5358787533,       -0.1124402070,        0.3524054671,  0.1951034935,        0.5922747064,        0.0214166048]


cut=1.3549
#cut=1.6825
N_c=100
N=51
#sigma=3.06

#icosohedral one
x38_1=[1.008361125057741, -0.769633980599810, -0.559171817871104, -0.509096148186660,   1.089162554039077,   1.493257400206362,-0.509096148167876,  -1.083602442204281,  -1.497297057921385,-0.094670886737197,  -0.752474668428163,   0.546704847883737,-0.094670886726391,   0.287419747651941,  -0.884587025672089, 0.437484411864528,   0.587876417632846,   1.809297572314977,-0.509096148166006,   1.089162553975334,  -1.493257400259897,-0.509096148182748,  -1.758865693549359,   0.567876927204396,-1.051607156787838,  -0.983328451416249,   0.000000000013715,-1.051607156782287,   0.795529428237470,  -0.577985961926859, 1.008361125048545,   0.293974021705785,   0.904759006905073,-1.051607156790282,   0.795529428262142,   0.577985961878354,-1.051607156780777,  -0.303865202559347,  -0.935200931379506, -1.051607156793712,  -0.303865202519426,   0.935200931377932, 0.433986584080560,  -0.477568670182377,  -1.469805233980068, 0.433986584078187,   1.250291010396660,  -0.908389591474013,-0.094670886738626,   0.287419747689702,   0.884587025658510, 1.008361125061060,   0.293974021667163,  -0.904759006903675, 1.008361125055377,   0.951319917798398,  -0.000000000013331, 0.437484411867450,  -1.539080442423734,   1.118207395495087,-0.509096148171778,   1.756741919810773,  -0.574413230685629, 0.437484411889554,   0.587876417555611,  -1.809297572334021, 0.437484411882917,  -1.539080442471467,  -1.118207395423336, 1.584073743697131,  -0.000000000001384,   0.000000000010955, 0.437484411878189,   1.902408049704833,  -0.000000000037579, 0.470745098913714,  -0.000000000000411,   0.000000000003256,-0.509096148188586,  -1.083602442140365,   1.497297057960599, 0.433986584069463,  -1.545444680531982,   0.000000000035987, 0.433986584065622,   1.250291010435437,   0.908389591426644,-0.509096148164505,  -0.003436338133663,  -1.848264300362580,-0.509096148179723,   1.756741919835293,   0.574413230603596,-0.509096148174893,  -1.758865693573600,  -0.567876927136356, 0.433986584060231,  -0.477568670119635,   1.469805234006457,-0.509096148190070,  -0.003436338054765,   1.848264300355686,-0.094670886729635,  -0.752474668451500,  -0.546704847852925,-0.094670886731947,   0.930109841538431,  -0.000000000020507, 1.008361125050007,  -0.769633980575941,   0.559171817917904,-0.631627748248736,   0.000000000000551,  -0.000000000004368]

#test config
x38_2=[1.3917420340506055 2.9244615476741878 3.6806171489326256; 2.6407839048632376 -3.202433092413183 -1.1053327516299123; 4.223140410098944 1.0266233037194337 1.1979482959543735; 1.3222627609380186 2.4871454887119717 -4.029956622155456; 1.2350780716871212 -2.451905908941632 -3.713061521086832; -1.6599825386887748 -3.728720290193078 1.5595869375028455; -2.9610858276187253 0.5991600484829195 3.8202780272506462; 1.4751533511165607 4.283352604149792 -1.5659405110901647; -2.8605533779782855 3.736144173040392 1.0013958402877594; 1.2409583132916266 -1.999030010179594 4.00116155492839; -4.430890043424774 -0.5145042665971437 -1.2609641828500011; -2.9752422008848898 0.10593110860124291 -3.889874373923068; -1.4648072531120462 3.0166927852081904 3.6559003395790115; -3.0736051402939415 -3.024533546153609 -1.0997328863104086; -1.6119244619012005 -2.3926569628929277 -3.709183984948473; 1.1881151740580798 -3.8204350758560617 1.5596482095539619; -4.367698226623193 1.3212012456108673 1.179211316868456; 2.711946967030185 -0.01948946195865298 -3.8890162857469135; -1.3762157791776217 4.3347505770721755 -1.6556384801554507; 4.148847034331602 -0.7832891138768183 -1.277991941027836; -1.6066840650045113 -1.9105286878107157 4.002038837246953; 2.8820626863236343 3.538080994003416 1.0712152323752475; 2.7465513344884283 0.42111548493653483 3.826575520634161; -0.23540467146298724 -4.9057339019628206 -3.4138708783658056; -3.0120393902107594 -1.2067176478452648 1.3667840474257331; -0.21128415846895426 -3.0589295094589546 -1.0523624699661525; 2.6937716383323576 -1.3901416011552428 1.3637404619808393; 2.7974092074902814 1.7512751951568355 -1.4171773793309563; -2.8948708235746445 1.9214974512457572 -1.45801001572196; -0.10872043339443681 0.5094001806197072 3.819755877339839; -0.13606313598375772 0.0477398180314115 -3.8552228039455767; 0.004106285444475739 3.6358110837036826 1.033685051006577; 1.289190474689894 -0.6635869940021778 -1.2411932655164664; -1.5645962849422275 -0.5842322881006652 -1.2367556411808394; -0.056319852400514875 1.8322593805287402 -1.4038044004089798; -1.5042475794379127 1.2156852982288744 1.1902835045545537; 1.3469786830974444 1.1242000990787824 1.1995989806012217; -0.15788325592419006 -1.2835311035306591 1.373933767321166]

energies=Array{Float64}(undef,N_c)
similarity=Array{Float64}(undef,N_c)
similarity_2=Array{Float64}(undef,N_c)
config_1=Array{Float64}(undef,N,3)
config_2=Array{Float64}(undef,N,3)
category=Array{String}(undef,N_c)

for i=1:N
	for j=1:3
		config_1[i,j]=x51_0[3i-(3-j)]/2.782
	end
end
#for i=1:N
	#for j=1:3
		#config_2[i,j]=x44_dec[3i-(3-j)]
    #end
#end


totalProfile_global = Dict{String,Int}()         #CNA profile of global minimum
atomicProfile_global = [Dict{String,Int}() for i in 1:N]

totalProfile_global = CNA(config_1, N, 1.3549, false, 1.)[1]
atomicProfile_global = CNA(config_1, N, 1.3549, false, 1.)[2]


#totalProfile_ico = Dict{String,Int}()           #CNA profile of icosohedral minimum
#atomicProfile_fcc = [Dict{String,Int}() for i in 1:N]

#totalProfile_ico = CNA(config_2/2.782, N, 1.3549, true, 1.)[1]
#atomicProfile_ico = CNA(config_2/2.782, N, 1.3549, true, 1.)[2]

println("CNA global mininum")
println(totalProfile_global)
println(atomicProfile_global)
#println("CNA ico mininum")
#println(totalProfile_ico)
#println(atomicProfile_ico)

#open("1000_cluster_energies.txt") do f
    #for i=1:1000
        #line=readline(f)
        #energies[i]=parse(Float64, line) 
    #end
#end

#println(energies)


function lj2(d)
    if d>=0.9
        sig6d6=sigma^6*d^(-3)
        #e=sigma^12*d^(-6)-sigma^6*d^(-3)
        e=sig6d6*(sig6d6-1)
    else
        e=0.50993431+7.9720358*(0.9-d)
    end
    return 4e/10000
end


function lj(x)
    E=0
    for i=1:N-1
        for j=i+1:N
            E+=lj2((x[j,1]-x[i,1])^2+(x[j,2]-x[i,2])^2+(x[j,3]-x[i,3])^2)
        end
    end
    return E
end

c6=-0.1132
c8=-1.5012
c9=35.6955
c10=-268.7494
c11=729.7605
c12=-583.4203

a6=0.0005742
a8=-0.4032
a9=-0.2101
a10=-0.0595
a11=0.0606
a12=0.1608

b6=-0.01336
b8=-0.02005
b9=-0.1051
b10=-0.1268
b11=-0.1405
b12=-0.1751

function elj2(d,theta)
    t2=cos(2*theta)
    t4=cos(4*theta)
    d_inv=d^(-1)
    e=d^(-6)*c6*(1+a6*t2+b6*t4)+d^(-8)*(c8*(1+a8*t2+b8*t4)+d_inv*(c9*(1+a9*t2+b9*t4)+d_inv*(c10*(1+a10*t2+b10*t4)+d_inv*(c11*(1+a11*t2+b11*t4)+d_inv*c12*(1+a12*t2+b12*t4)))))
    #e=c6*(1+a6+b6)*d^(-6)+c8*(1+a8+b8)*d^(-8)+c9*(1+a9+b9)*d^(-9)+c10*(1+a10+b10)*d^(-10)+c11*(1+a11+b11)*d^(-11)+c12*(1+a12+b12)*d^(-12)
    return e
end


function elj(x)
    E=0
    for i=1:N-1
        for j=i+1:N
            theta=atan(((x[j,1]-x[i,1])^2+(x[j,2]-x[i,2])^2)^0.5/abs(x[j,3]-x[i,3]))
            E+=elj2(((x[j,1]-x[i,1])^2+(x[j,2]-x[i,2])^2+(x[j,3]-x[i,3])^2)^0.5,theta)
        end
    end
    return E
end

open("/Users/tiantianyu/Downloads/CNA-records/ne51Bcna_results/51_10000_classify.txt") do f
    for i=1:N_c
	    line = readline(f) 
        #println(line)
        category[i]=line
    end
end

#println(category)

open("/Users/tiantianyu/Downloads/CNA-records/ne51Bcna_results/51_B_configuration.txt") do f
    for i=1:N_c
	    configuration = Array{Float64}(undef,N,3) # Initialise 3D array for the atom coordinates for each configuration in the file.
	    totalProfiles = Dict{String,Int}() # Initialise array to hold total CNA profiles
	    atomicProfiles = Any[]       # Initialise array to hold atomic CNA profiles
	    
        line = readline(f)      #first line, to see if it's reseed
        line = readline(f)      #skip the second line
        #println()
        for j=1:N
            line = readline(f) 
            for (k,x) in enumerate((split(line, r" +"))[2:4]) # For each component of the coordinate
				configuration[j,k] = parse(Float64,x) # Store the component
			end
        end
        #println(configuration)
        energies[i]=elj(configuration)
        #println(energies[i])
        totalProfiles = CNA(configuration/2.782, N, 1.3549, true, 1.)[1]
        atomicProfiles = CNA(configuration/2.782, N, 1.3549, true, 1.)[2]
        similarity[i]=similarityScore_one(1, 2, [totalProfile_global,totalProfiles],[atomicProfile_global,atomicProfiles],"total",N,)
        #similarity_2[i]=similarityScore_one(1, 2, [totalProfile_ico,totalProfiles],[atomicProfile_ico,atomicProfiles],"total",N,)
        if energies[i]<-0.0049 && category[i]=="fcc"
            println(i)
            println(energies[i])
            #println(category[i])
            #println(totalProfiles)
            println(similarity[i])
        end
    end
end

#open("/Users/tiantianyu/Downloads/13_10000_energies.txt","a") do io
    #println(io,energies)
#end
#println(similarity)
#println(similarity_2)

#for i=1:N_c
    #if energies[i]*10000>-161
        #println(i)
    #end
#end
#open("/Users/tiantianyu/Downloads/13_10000_similarities.txt","a") do io
   # println(io,similarity)
    #println()
    #println()
    #println(io,similarity_2)
#end

println(energies)

