using ParallelTemperingMonteCarlo
using BenchmarkTools, StaticArrays

ico_13  = [[-0.0000000049,       -0.0000000044,       -0.0000000033],
[-0.0000007312,       -0.0000000014,        0.6554619119],
 [0.1811648930,      -0.5575692094,        0.2931316798],
[-0.4742970242,       -0.3445967289,        0.2931309525],
[-0.4742970303,        0.3445967144,        0.2931309494],
 [0.1811648830,        0.5575692066,        0.2931316748],
 [0.5862626299,        0.0000000022,        0.2931321262],
[-0.1811648928,       -0.5575692153,       -0.2931316813],
[-0.5862626397,       -0.0000000109,       -0.2931321327],
[-0.1811649028,        0.5575692007,       -0.2931316863],
 [0.4742970144,        0.3445967202,       -0.2931309590],
 [0.4742970205,       -0.3445967231,       -0.2931309559],
 [0.0000007214,       -0.0000000073,       -0.6554619185]]

 
ico_55 = [[0.0000006584,       -0.0000019175,        0.0000000505],
[-0.0000005810,       -0.0000004871,        0.6678432175],
[0.1845874248,       -0.5681026047,        0.2986701538],
[-0.4832557457,       -0.3511072166,        0.2986684497],
[-0.4832557570,        0.3511046452,        0.2986669456],
[0.1845874064,        0.5681000550,        0.2986677202],
[0.5973371920,       -0.0000012681,        0.2986697030],
[-0.1845860897,       -0.5681038901,       -0.2986676192],
[-0.5973358752,       -0.0000025669,       -0.2986696020],
[-0.1845861081,        0.5680987696,       -0.2986700528],
[0.4832570624,        0.3511033815,       -0.2986683486],
[0.4832570738,       -0.3511084803,       -0.2986668445],
[0.0000018978,       -0.0000033480,       -0.6678431165],
[-0.0000017969,        0.0000009162,        1.3230014650],
[0.1871182835,       -0.5758942175,        0.9797717078],
[-0.4898861924,       -0.3559221410,       0.9797699802],
[-0.4898862039,        0.3559224872,        0.9797684555],
[0.1871182648,        0.5758945856,        0.9797692407],
[0.6055300485,        0.0000001908,        0.9797712507],
[0.7926501864,       -0.5758950093,        0.6055339635],
[0.3656681761,       -1.1254128670,        0.5916673591],
[-0.3027660545,       -0.9318173412,        0.6055326929],
[-0.9573332453,       -0.6955436707,        0.5916639831],
[-0.9797705418,       -0.0000006364,        0.6055294407],
[-0.9573332679,        0.6955423392,        0.5916610035],
[-0.3027660847,        0.9318160902,        0.6055287012],
[0.3656681396,        1.1254115783,        0.5916625380],
[0.7926501677,        0.5758937939,        0.6055314964],
[1.1833279992,       -0.0000006311,        0.5916664660],
[0.6770051458,       -0.9318186223,        0.0000033028],
[0.0000006771,       -1.1517907207,        0.0000025175],
[-0.6770037988,       -0.9318186442,        0.0000007900],
[-1.0954155825,       -0.3559242494,       -0.0000012200],
[-1.0954155940,        0.3559203788,       -0.0000027447],
[-0.6770038290,        0.9318147872,       -0.0000032017],
[0.0000006397,        1.1517868856,       -0.0000024165],
[0.6770051155,        0.9318148091,       -0.0000006889],
[1.0954168993,        0.3559204143,        0.0000013211],
[1.0954169108,       -0.3559242139,        0.0000028458],
[0.3027674014,       -0.9318199253,       -0.6055286002],
[-0.3656668229,       -1.1254154134,       -0.5916624370],
[-0.7926488510,       -0.5758976290,       -0.6055313954],
[-1.1833266824,       -0.0000032040,       -0.5916663649],
[-0.7926488697,        0.5758911742,       -0.6055338624],
[-0.3656668594,        1.1254090319,       -0.5916672580],
[0.3027673712,        0.9318135061,       -0.6055325919],
[0.9573345621,        0.6955398357,       -0.5916638820],
[0.9797718586,       -0.0000031986,       -0.6055293396],
[0.9573345846,       -0.6955461743,       -0.5916609025],
[-0.1871169480,       -0.5758984207,       -0.9797691397],
[-0.6055287318,       -0.0000040259,       -0.9797711497],
[-0.1871169667,        0.5758903824,       -0.9797716067],
[0.4898875091,        0.3559183059,       -0.9797698792],
[0.4898875207,       -0.3559263223,       -0.9797683545],
[0.0000031136,       -0.0000047513,       -1.3230013639]]
 n_traj = 10

 index = 5
 vec_shift = SVector(8,8,8)
 # for desktop runnerdir = "/home/grayseff/Code/Brass_potential/"
 runnerdir = "/home/ghun245/RuNNer-master/Brass_potential/"
 atomtype="Cu"
 pot = AbstractMLPotential(runnerdir,atomtype)


nmtobohr = 18.8973
copperconstant = 0.36258*nmtobohr
pos_cu13 = copperconstant*ico_13
pos_cu55 = copperconstant*ico_55
AtoBohr = 1.8897259886


 bc_cu13 = SphericalBC(radius=8*AtoBohr)
 bc_cu55 = SphericalBC(radius=14*AtoBohr)
#starting configuration
start_config13 = Config(pos_cu13, bc_cu13)
start_config55 = Config(pos_cu55, bc_cu55)
states13 = []
states55 = []
states55_a = []

for i = 1:n_traj
    push!(states13,start_config13)
    push!(states55,start_config55)
end

for i = 1:5*n_traj
    push!(states55_a,start_config55)
end

##
 function trialrun_singular_13a_10traj()
    for i in 1:n_traj
        E = RuNNer.getenergy(runnerdir,start_config13,atomtype,index,vec_shift)
    end
 end

 function trialrun_singular_55a_10traj()
    for i in 1:n_traj
        E = RuNNer.getenergy(runnerdir,start_config55,atomtype,index,vec_shift)
    end
 end
 function trialrun_singular_55a_50traj()
    for i in 1:5*n_traj
        E = RuNNer.getenergy(runnerdir,start_config55,atomtype,index,vec_shift)
    end
 end
function trialrun_multiple_13a_10traj()
    testfile = writeinit(runnerdir)

    for config in states13
        writeconfig(testfile,config,index,vec_shift,atomtype)
    end
    close(testfile)
    energyvec = getRuNNerenergy(runnerdir,n_traj)
end
function trialrun_multiple_55a_10traj()
    testfile = writeinit(runnerdir)

    for config in states55
        writeconfig(testfile,config,index,vec_shift,atomtype)
    end
    close(testfile)
    energyvec = getRuNNerenergy(runnerdir,n_traj)
end
function trialrun_multiple_55a_50traj()
    testfile = writeinit(runnerdir)

    for config in states55_a
        writeconfig(testfile,config,index,vec_shift,atomtype)
    end
    close(testfile)
    energyvec = getRuNNerenergy(runnerdir,n_traj)
end

##
thirteen_ten_single = @benchmark trialrun_singular_13a_10traj()
thirteen_ten_multiple = @benchmark trialrun_multiple_13a_10traj()
fiftyfive_ten_single = @benchmark trialrun_singular_55a_10traj()
fiftyfive_ten_multiple = @benchmark trialrun_multiple_55a_10traj()
fiftyfive_fifty_single = @benchmark trialrun_singular_55a_50traj()
fiftyfive_fifty_multiple = @benchmark trialrun_multiple_55a_50traj()
##
#trialing the new sed structure.

testfile = writeinit(runnerdir)


for config in states55_a
    writeconfig(testfile,config,atomtype)
end
close(testfile)

##
#close(editfile)
function line_number(traj::Int64,atom::Int64)
    zeroline = 1 + (traj-1)*(4+55)
    lineno = atom + zeroline
    return lineno
end

newvec = SVector(8,8,8)


#function trialrun_55_50()
##

##
println(
thirteen_ten_single,
thirteen_ten_multiple,
fiftyfive_ten_single,
fiftyfive_ten_multiple,
fiftyfive_fifty_single,
fiftyfive_fifty_multiple)
##

function writingtest()
    testfile = writeinit(runnerdir)

    for config in states55_a
        writeconfig(testfile,config,index,vec_shift,atomtype)
    end
    close(testfile)

end

# function editingtest()
#     for j_test in 1:50
#         linenumber = line_number(j_test,38)
#         RuNNer.writeedit(editfile,linenumber,pos_cu55[38],newvec)
#     end
#     close(editfile)
#     cd(runnerdir)
#     run(`./edit.sh`)
# end
##
test_writetime = @benchmark writingtest()
#test_edittime = @benchmark editingtest()
##

function edittest()
    testfile = "$(runnerdir)input.data"
    for j_test in 1:50
        linenumber = line_number(j_test,38)
        run(`sed -i "$(linenumber)s/.*/atom $(vec_shift[1]) $(vec_shift[2]) $(vec_shift[3]) Cu 0.0 0.0 0.0 0.0 0.0/" $(testfile) `)
    end
    #energyvec = getRuNNerenergy(runnerdir,n_traj)
end
##
test_newedit = @benchmark edittest()
##
Larger_cluster =[   -6.8855333875        5.8560999049       -5.2084094698
-8.3787057372        2.4568517757        3.4231528473
-1.2011350865        8.8269853304       -4.9296714374
 3.2996423510        0.0263385183       10.2266592489
-1.4125121675       12.4171979471       -3.6041786622
-7.3292762025       -3.6931564779       -7.9191091700
-12.7130875149       -1.9311112385        0.8391323059
-10.2113586698        4.9599898998       -3.6182937205
-5.6612401822       -2.3495819044      -11.0703876097
-13.3859932862        6.7500313189       -4.4301478512
-0.1260621929        6.2576185366        8.4732580526
-3.5823381487       -5.5850205690        6.2546461885
 4.8677519099      -11.8660472308       -2.6296015934
 6.5335706279       -4.2374285374       -6.4203590937
-4.1074822390       -5.2939014588       -9.2775117259
11.8549254178        7.2141360922        4.4044785366
-3.4799772235       -2.9845186077      -14.0771158431
 5.4167810184        7.2721307155        5.6536485555
-4.3750179338        3.9686832216        2.9344744325
-10.3517180097       -2.5114178171       -2.0813355428
 7.2336970304       -9.1911011530       -4.1844007819
-10.5522461243       -5.5616534935       -7.9310248125
 4.3561316403        9.4417955638       -0.1666358445
-3.8268322423       -8.3149135202        8.7514269233
 5.4237373088       10.8148690663        6.9291701920
 8.1509155080      -11.7352307378        2.9690004632
-2.5029619281       -8.1850978089       -7.3897086255
11.4934800536        3.4807763795       -4.5601002498
-5.7449473625       -6.6474351469       -6.0574442944
-1.9771157108       13.0884656698        0.1295739687
 9.7126881011       -7.5662753506        7.3259088265
-4.0445085566       -5.9770676676       -2.7467759182
 3.3017912405       -6.1317853779        8.2412124522
 8.2421677956       -4.7544455457        9.5566631447
 9.8760830715        6.9858622308       -4.3040842436
 7.5416006188        7.6401019377       -1.3915029341
-12.6275475320       -5.6911466648        1.5815364981
 0.6292388248        1.1613674834        1.0498784273
 5.2522582364        6.7749229321       12.1914364487
 4.7946517193        0.1857079311       -4.5852877633
 5.0955609857       -2.7750029744        8.5932254037
 2.0162579548       -7.5213374020        1.2941048079
 2.0681101935       -6.1039916811       -2.0847764942
-10.4104998640       -9.7584668386       -2.6355247795
 3.6686131037        9.6002130415       10.1409621146
-4.3969066364      -12.3837070815       -1.6272498192
-4.6126669432        4.2917452419       12.8268150979
-6.0831345302        3.5919151751        9.4439710178
-5.3031451247        3.4141855840       -7.7876533546
-5.7734904653      -10.1494495953       -7.4422206839
10.8067095467        9.3492587130       -1.3748059646
-0.8773589268      -11.0018604711       -5.4358202867
-0.0711077565        2.7147721130        7.1536070522
-2.1089196294       -0.5369144790        6.3971970222
-9.4723306778       -0.0136487469        0.7288785450
12.5161482412        5.8890886460       -1.7132064630
-12.5764042269        5.5617801567       -0.8457130588
-6.8493043818       -7.4854679960        6.4460473107
 8.7422480350       -5.0205155931       -9.3124381707
 2.0799384728       13.1998770308       -5.0793487450
 8.8140133110        4.5902184349       -7.1724869876
 8.3599282020        1.3630244751       11.8528456695
10.9348133729       -4.0512543804        6.8458438162
 3.9109896549        0.5094432937       -9.4548928673
10.2129643423        6.1458976762        7.6898053491
 7.7723725512       -6.8790586366        0.6850518560
-10.2861648286        2.0134296456       -9.4519429042
-3.9563495107        1.1684223348       -2.1334559957
 2.1377687814        9.7146007353       -6.3371792693
-7.5666856044      -10.7528721928       -0.2107340042
-1.6330379680        5.9893393482       -2.4155761037
 4.3556689875      -10.5433199402       -6.3214771981
-4.9180984659        6.1598169478      -10.2511024679
-1.5030000377        0.2765931031      -13.3090701470
10.1405176814        6.5604220923        1.1159435853
-3.3413663604       -2.8736169530        3.7867037491
 3.7397088590        2.9712801207        1.1061457881
 6.7937052390        3.9310876503       14.1774455126
 1.4043210108       -3.1925928310        9.4011710975
-7.3626792972        1.1519400105        6.9672781905
 4.3301093467        9.1735081669       -9.2316091185
 5.4046104461       11.4918129670       -6.3235125577
 0.1910638454        7.2592287491       -8.1981342601
 5.3538916750        2.9435556983       -7.0989906925
-4.8579816681       11.5279683132       -2.0204689767
 1.3390203598       -8.3491289563       -6.9855823990
-7.8737225654        6.9342558925       -1.5995781247
11.9256162344       -1.6648456126       -0.1619591541
-1.3137003696      -13.1921344148        0.6664934047
-10.3224972087       -6.2295534026       -1.3239960345
-4.9441195639        5.0651916681       -0.8058016742
-5.3147598218        0.3880518556      -13.5647414257
-7.5820523531        9.7739921971       -4.1340711197
-8.7064026959        2.5303226850       -6.1414125854
-7.3193504530        5.8638651363        2.1176758596
 5.7063037697       -2.8931814725       -9.8939012012
 2.3141300388        0.0728841409      -12.9099850744
-8.4381353620        5.3331492229       -8.6625081464
-6.2020591926        7.1488013566       10.6833427675
-0.1944404379        9.7950565332        9.7287569127
-3.7126544061        0.9232978160      -10.2147782000
12.8476166726        0.7604770845        2.6656537976
 4.3381891587        5.8773900904       -1.3579736258
 1.5944299978       10.3815410254       -2.6387309748
-8.9379380234       -4.2199933650      -11.2233922451
-2.4964587249       -4.7056129010       -6.0028393328
-7.1578884252       -0.6503904034       -2.1246908720
-1.2910256225       -6.0766676769        3.2131566902
-1.5358064160        1.9987831320        3.8412705831
 6.7089458059        0.6006620839        8.6118059664
-0.8938190926       -0.6313689440       -1.3936370286
-4.3494542102       -8.8382566651       -0.3099169739
10.1031981610       -7.7618587130       -2.1034446790
 8.7037461292        9.0819693275        5.7026255490
-4.0165999484        9.8431516771        9.0899421283
 5.9350019886        5.6849253933       -9.5921421618
-0.5526472160        2.0753935328       -3.5300772504
 2.0569284186      -10.8566115188        0.1112871402
 9.7460574718       -1.3200907435        9.3959617464
 9.5215736322       -0.9819957514        2.7761824647
 6.5877147068       -7.8211344056       -7.8322442773
-1.8884012632       -6.0167297348      -12.3039189252
-0.8936941104       -2.5314307327       12.4029917417
 5.1177990452      -13.0591094031        0.9231673547
 4.2936146928        3.2048163901      -11.8739501694
-0.5370124612        0.1145942304        9.8158248826
 2.0656552808       12.4005319817        8.0632166104
-4.0615081861       -9.4774897905       -4.0856700357
-0.8775731168      -14.4928792722       -6.8013183793
-9.4339446759       -3.7925524717        1.4914106847
-4.7640588296       11.0880842867        5.4582090981
 6.1728238317       -2.7766233744        2.8762266695
12.3173322590        2.1174548870       -0.9702855502
-6.2428942624       -1.9080155577        1.4088064635
-4.3487254941        0.2258671404        9.2658156212
-10.6404176944       -0.6830532773        7.1447501034
 3.1508275947        3.5952645682       -4.2755342483
 9.4521857611       -6.4014453211       -5.7054807228
 2.0528464892        3.8833440335       -8.8956033866
-10.3070716976        1.2193892361       -2.8576218726
 6.5166403614        5.2947811758       -4.3243471624
 2.4751863539        6.6079422156      -11.2242061067
 5.7565336127       -6.3669505068      -11.3538785190
 7.0537039418       11.8713212815        3.6040798949
-11.7272776838        0.5743730293        3.6273310272
-5.6793908618       -3.1142950266       -4.6518826196
 3.4630825355       -2.1703492739       -7.0316607567
-7.1476102609       -4.3474094701       -1.3897554343
-5.5519007786       -2.2599534869        6.6906736749
 4.9285711466       -5.4037927756       11.3927912681
 1.9074457619       -2.6845492893      -10.3675466354
-13.5178904125       -8.1125694010       -1.2340807573
-1.8872298465       -2.4958029240      -10.7692316948
-6.5857853741        1.0272844956       12.1304357834
-2.3596305062       10.1669822157        2.6066913068
-8.4487665952       -1.3184467540        4.2678593715
-8.2017560096       10.5045481880       -0.3702688802
-0.8187628251        4.1707278846       13.3321087886
13.1791082263        4.5378179644        1.8819825800
 7.7751579433      -10.5026032231       -0.5799192727
-1.5436603892       -8.7815559386        5.6576577995
-6.1605485113        1.8304928759        0.6329187651
 5.9188173486        2.5097669660       -1.7638380919
-7.7690394024       -1.5846620899        9.5970166565
-1.8340884869        9.5512513870       -1.1616091398
 0.5365557846       11.6213891871        4.7138324031
 1.7444172311       -6.8030466760        5.0496189880
-8.3569168071        4.4520302890       12.2556514241
11.3898475622       -5.4164348587        0.6548558926
 2.7010894613       12.5815743833       -8.7352403879
 5.2372756333        3.2561350933       10.8673694058
 2.9917564604        4.0696615567       13.7930693238
 1.9487677826       -6.2068840985      -11.8949197997
 5.3395363251        3.6972473419        4.3759365709
-0.7565617196       11.7372313362       -7.3149201328
 8.3691507512        1.6994417201        5.2950206989
 2.0763705044      -13.1742143558       -4.8077415703
-4.0139217294       -2.4819476301       -1.4199230808
 1.6643880272        6.9071806021       -3.7743950268
 6.6413990574       -5.5045220417        6.3950464395
-13.5067859447       -0.6675033046       -2.7945932188
-2.0955919578        3.1668893174        0.0668532129
-0.2737196969       -8.9754281930      -10.3886404633
-2.5026062545      -11.6597199803       -8.7566466157
-6.8734139069        2.8994734052      -11.1653267237
-4.6999200351       -2.3986748758       11.8297653761
-7.1896252398        0.1032421747       -8.6357614680
-5.3559985616       12.1427600109        1.7538535351
 7.2037962683       -5.5753118855       -2.8465997436
-3.7383687955        3.9049778863       -4.4008908119
-10.5295784031       -1.7802275239       -8.7512218249
 7.9660155862       -2.0721793683        6.1763011332
-11.6585859067       -3.2096972756        4.3853371857
-11.5831427174        4.3272411863        2.7219785623
 6.1202521708       -0.2071313975      -12.4098960088
 0.6051536610        4.6325901786        2.3040303036
10.3932549116        1.0802671266       -7.3902444649
-7.2526447945      -11.3704182923       -4.0421147637
-5.1883202674        8.6160362231        0.4944597944
11.6901953618        3.4583598220        5.2424857885
 2.1273778322        8.8929558652        6.8274172767
 6.4337650417       -8.1553984531        9.1534707181
10.3030342907       10.1121638490        2.3726512399
11.2517034240       -0.2896196412       -3.8043944043
 7.0083254760       -0.5390525170       -7.3331696370
 7.5787086796        2.1957366093       -9.9149132048
 4.7621339601       -8.8314793700        5.8793170654
-2.7998010088        0.8677776788       12.7179699136
-12.0961889190       -6.8707476196       -4.5886623551
 1.4547713003       -9.4580131473        7.7069978198
 0.4827799644        3.5095071767      -12.3722870085
-9.0732380759        5.6097703773        8.6473925625
-9.7060249263        6.6881663784        4.9491128484
 3.5478606334       -3.4397545119        5.4754170168
-3.7857097357        2.8034143651        6.6300389922
-2.4230757282        7.0827134009       11.3305120535
-8.8912367260       -4.9917731473       -4.6510427733
 2.6660466639        0.8354646297       -1.8226487514
 9.8785571095        2.7941174993        1.9255495870
 7.1306024247        8.0708019384       -6.8130589020
 0.0826975116        0.7547789077       -9.9324868832
-1.7242245508      -11.5025141287        8.1422553295
 4.2914638752       -3.4144847029       -3.5769882930
-12.1316594747       -3.1185086353       -5.4148367972
 1.9877769922       -4.1926434652        2.4210534081
-7.2184923529       -7.8837451428       -2.7113413742
-7.0666795234        3.0438490236       -2.8687155806
 2.1497450852        5.3815362980        5.5798752000
 1.3112516768      -12.1593137071       10.2999784248
-4.0809723598      -12.9565760386       -5.4505003903
-10.3174822257        7.7061210554        1.2397421246
-2.9266806015        9.2759592597       -9.1303455901
-1.1595379603      -10.4130834854       -1.7241074777
 7.0241165311        8.3610785564        2.3426119006
 4.8702809813       -8.3184652971       -1.3015711166
 3.6706642965        2.5648609098        7.5606246904
-3.4101569860        6.5900190111       -6.7595267494
-9.5448609741        1.8803954944        9.7897014296
 8.4737617851       -3.2449257231       -0.0735485508
 1.1855708762        4.1179180390       -1.2548122464
11.0678247580      -10.3410945540        5.0235748499
-4.6091341143        7.5332928711        4.2210878041
-1.7113505250        9.0074937952        6.2985565763
-11.8291977465        4.4027575719       -6.9418232977
 3.6931285910        6.0937555868        8.8849090908
 4.3359612550       -6.9962644276       -4.9434745001
 1.4484531766        3.3882581604       10.4797237729
 4.1211887236       -3.3712714355      -13.2710024062
-1.5287465642      -12.4011223484        4.4212555504
-7.6294061259        9.4976715091        3.3444223245
-2.4637734066       -1.2341585593       -4.5698059095
-1.2769825134       -9.6612550422        1.9602591405
-1.7629668913        4.1523373134       -9.2787060016
-1.1638941630       -6.8978219865       -0.4142690959
 0.0736988007       -1.3262655541        3.5312491447
-8.8815175559       -1.2358233223       -5.4271453883
-7.4935400223       -7.1349403681        1.0793802209
 8.1176464543       10.4146520067       -3.8660048975
-0.1731157545       -3.8437956647        5.9891967020
-12.6793480396        1.8282125204        0.0232398405
-5.7107084517       -5.8119267443      -12.5772579423
-8.9797095459       -8.5523065053       -6.0448400856
-1.2280545554      -13.9171626029       -3.0626424350
-8.7661073844       -0.4089954307      -11.9428698346
 5.1110788964       -9.6363951635        2.1290124355
 1.7985799544      -13.6755372714        2.7093426704
 1.0171511232        0.7747332465       13.1980085277
11.9314421277       -6.7660490100        4.2626057476
 3.8088878688       10.0506287652        3.5479108373
-5.5815770121        0.6239331622       -5.3619622228
13.4377104110        8.2723734196        1.1277833554
-7.4030266548       -7.2310459609       -9.3768225218
 7.7758184814      -10.8672965510        6.7264037191
-0.2793761091       -5.4828738929       -8.9603387111
 4.5228201627      -11.4804981957        8.4889313578
-10.9012794100        8.7074417474       -2.4493517607
 4.8661358366       -4.7243353836       -0.0404251064
 3.7597398594       13.5588088374        4.8112406012
 0.5866393435        8.1145859970        3.4948639997
 1.6744713047       -0.6331088056        6.8672982318
 3.3880928694       -0.8253495735        2.0511711750
11.3929532202       -0.3207135496        6.0606256626
10.6535508928       -9.0896175050        1.4784164339
 1.5019713939       13.8482119072       -1.3996418687
10.0797438590        2.4085550531        8.5747935535
 3.6863463303        6.3673240876       -6.7863180643
 2.1416586668        1.8784155400        4.2837515346
 7.8188776744       -1.8791344017       -3.7213750917
-0.7418835646       -9.0628758641       10.9490144755
-5.8356813393       -4.9888403824        9.2272948149
 1.0493690455       11.0279086540        1.0449995016
-0.8875917974       -4.0618576060       -2.7565231740
-2.3323474512        3.4958962506       10.0051805783
 6.6015387027        1.0022874727        1.9916097931
 1.4099837291        6.9660479768       11.8308189364
 0.3208789655       -3.1558002143      -13.6922548546
-9.8161115497       -6.6196830473        4.0689518774
 0.9654449924       14.5005181758        2.2874649210
 3.5424189971       -5.6436228956       -8.4727801588
 2.9406009392       -2.5452044833       12.7932455383
-4.7430024910      -10.7177222918        5.8865931918
-1.3404454023        6.8717516375      -11.6630334477
 2.0302656307      -14.1788371793       -1.1474406901
 9.2089951718        4.2033323767       -1.7385193916
 5.0707680676       -0.0856184993        5.3147944543
-2.2441637409        6.6468631218        1.3417621982
-0.3120738207       -1.9729552559       -7.4741015998
-2.4476454393       -3.1314322689        8.9321415282
 5.0098839550       -6.2011630207        3.2527684101
 9.1938166438       -1.2864231016      -10.1579230927
-2.7526076786       -5.7833128597       11.4470326674
-4.0593303200       -1.8035050973       -7.7894196712
 4.8591699445        8.6936638788       -3.8716277037
 6.6642955911       -1.9845542761       11.7188282200
 1.3222303255       -4.8741371143       -5.6036536231
-10.5559532982        3.1083708114        6.2723837739
 1.6134594402        1.2424278212       -6.5192347038
-4.1180500134       -8.7538077091      -10.6842899438
 5.5706739145       -1.1412332955       -0.8660124703
 7.6360840854       11.2441003918       -0.1409157303
-10.0308352720        7.7034825949       -6.1098687264
 7.0133198341        7.9701504292        8.9859916062
-0.8738041692       -7.5085679396       -4.0833602634
 4.8370363071      -12.4147922077        4.7319727994
 9.0661393903       -4.7017011376        3.5786051661
 2.0402033693       -2.6023677050       -0.7902150500
 8.1556341281        1.8353675956       -4.5742174235
 3.1342442986       -8.8215829386       10.9226557143
-3.0494745646       -0.1076898189        1.3929157547
 1.1075258877        7.5594501492       -0.1311904265
-1.6309288378        5.5001212136        5.0772814308
 4.3325721432       12.9698567863        1.0900216188
 8.5807856759        5.4777163834        4.4076439675
-8.8374565316       -4.1259473270        6.8806775534
 6.9455681756        4.3731294339        7.6716771052
 7.8895914439       -3.6036416712      -12.8118067725
10.7642901527       -4.0521969375       -2.9655125369
-9.3488418391        3.7563888492       -0.0994689011
 1.5336498640      -12.9804739174        6.5494465813
 2.0723364816       -9.6419108831       -3.4272096527
-2.1159604252        1.4879019233       -6.8577305365
-7.7284823512       -9.8734399313        3.5520652698
-3.9087183818        6.3222615726        7.8848657142
 4.8421327576        0.7219165802       13.5742655337
 3.7915213455        6.5199801761        2.3110448633
 4.8881454025       12.2847420162       -2.6299504745
-10.6886132990       -9.0174939714        1.1793708387
-6.5153100797        8.5234655213       -7.6745035653
-4.5578220174      -11.6193811369        2.1531944371
 1.0888223226       -5.8186635148       11.8948857112
-0.2179770226        4.6697035162       -5.8487144689
 6.8985552639        4.7872067320        1.1165292618
-1.7985504569       12.5159317281        7.5153960697
-4.5468782485        7.9276515791       -3.2990821126
-4.1804867756       10.7622804916       -5.7562738931
-13.5379932107       -4.4009093040       -2.0019430353
 0.4499014478       15.1299706101        5.9622793843
-2.4592995555       13.6869052326        3.8758669145
-0.5072270007       -6.4086570084        8.4734170419
-6.5988550927       -4.7200219165        3.9331329331
-3.3400679172        3.6405504448      -12.6567764145
-13.4545938420        3.0573021404       -3.6101663711
10.0643394793       -2.6814826600       -6.5920670095
 1.2473463814       -1.4245510502       -4.2136669394
-12.0423168937        0.6508006616       -6.2070145357
-7.2526435731       -2.8438196313      -14.3914910856
 8.5329867523        5.0735440155       10.9686330559
-6.9605941729        8.3782464445        7.0508020996
 8.1013543598       -8.2123207832        4.1030753709
-5.1875739349        0.5223920608        4.1678591286
 0.6830680446        9.9591111789      -10.4589119435
-4.5180020197       -7.9839239902        3.4172234900
 1.7643872424      -10.2606395411        3.9408893625
 3.5601049830       -9.1088134658       -9.8632701132
12.4710293508       -3.0239260288        3.4655832997
-6.7511485866        4.7487489520        5.8028847344
 8.9600975629        0.4720797288       -0.9208423973
 1.3383105214      -11.8249759875       -8.3566182300
-4.3181646401       -5.2467968313        0.9804184982
-1.1731723267       -3.3925756343        0.8471566011]
arraytesting = [SVector{3}(Larger_cluster[i,:]) for i=1:380]
##
bc_380 = SphericalBC(radius=20*AtoBohr)
#starting configuration
start_config380 = Config(arraytesting, bc_380)
states380=[]
for i = 1:5*n_traj
    push!(states380,start_config380)
end
##
testfile_2 = writeinit(runnerdir)


for config in states380
    writeconfig(testfile_2,config,atomtype)
end
close(testfile_2)
##

function line_number(traj::Int64,atom::Int64)
    zeroline = 1 + (traj-1)*(4+380)
    lineno = atom + zeroline
    return lineno
end

function writingtest()
    testfile = writeinit(runnerdir)

    for config in states380
        writeconfig(testfile,config,index,vec_shift,atomtype)
    end
    close(testfile)

end
function edittest()
    testfile = "$(runnerdir)input.data"
    for j_test in 1:50
        linenumber = line_number(j_test,38)
        run(`sed -i "$(linenumber)s/.*/atom $(vec_shift[1]) $(vec_shift[2]) $(vec_shift[3]) Cu 0.0 0.0 0.0 0.0 0.0/" $(testfile) `)
    end
    #energyvec = getRuNNerenergy(runnerdir,n_traj)
end
##
test_writetime_large = @benchmark writingtest()
test_newedit_large = @benchmark edittest()
##

println(test_writetime,test_writetime_large,test_newedit,test_newedit_large)